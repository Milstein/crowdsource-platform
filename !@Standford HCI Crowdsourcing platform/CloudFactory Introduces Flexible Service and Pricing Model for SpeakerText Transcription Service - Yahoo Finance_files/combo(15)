YModules={};YUI.add("module_platform",function(K){var i,T=K.Lang,ac=K.Array,an=K.Object,av=T.isString,G=T.isUndefined,aq=T.isBoolean,ao=T.isFunction,t=T.isObject,a=T.isArray,P=T.later,F=true,p=false,X=null,at=0,w=X,U=X,ak=X,ar={},W={},af={},aj={},ah=[],N={init:function(){}},O=["closeView","hideView","isViewOpen","openView","openViewHtml","refreshView","showView","setView"],h="modulestart",y="viewload",ag="viewunload",aA="started",aw="props",n="config",J="res",ay="resourcemgr",V="signal",I="state",ae="message",Q="MPServices",B="ModulePlatformProvider";function al(aB,L,Y){if(!t(L)){L=new Error(L);}if(U.debug){throw L;}else{var A={type:"error",errorType:aB,error:L};if(t(Y)){K.mix(A,Y);}i.fire(A);}}function R(A,L){return t(ar[A])?ar[A].getService(i,L):X;}function D(aB,Y,A){if(A){var L=an(A);an.each(A,function(aC,aD){if(ao(aC)&&!U.debug){L[aD]=function(){try{return aC.apply(this,arguments);}catch(aE){al(aD,aE,{moduleId:aB});}};}});return L;}else{return N;}}function ai(L,A,Y){f(A,"viewevent",[Y,L]);}function ab(aB,Y){var aC=af[aB],aE,A,aD,L;if(aC){if(!aC[aA]){aE=aC[n];L=aE[aw];A=YModules[L.ns];aD=aE[I];aC.module=D(aB,L.type,A);aC.module.init(aC.api);aC[aA]=F;if(Y&&aD&&av(aD.view)){f(aB,y,[aD.view]);}i.fire({type:h,moduleId:aB});}}}function l(A){var L=ah.shift();ab(L,A);if(ah.length){ak=P(0,X,l,[A]);}else{if(at==1){at=4;i.fire({type:"ready"});}ak=X;}}function o(Y,L){var A=Y[L];delete Y[L];return A;}function ap(Y,A,aB){i.fire({type:ae,messageName:A,moduleId:Y,data:aB});var L=aj[A];if(L){an.each(L,function(aD,aC){f(aC,ae,[A,af[Y].api.getProperty("type"),aB]);});}}function az(L,A,Y){i.fire({type:"navigate",moduleId:L,url:A,target:Y});}function E(L,A){if(!(A instanceof Array)){A=[A];}ac.each(A,function(Y){if(!aj[Y]){aj[Y]={};}aj[Y][L]=1;i.fire({type:"listen",moduleId:L,messageName:Y});});}function H(L,A){if(A&&!(A instanceof Array)){A=[A];}else{A=an.keys(aj);}ac.each(A,function(Y){if(aj[Y]){delete aj[Y][L];i.fire({type:"unlisten",moduleId:L,messageName:Y});}});}function f(L,aD,aF){if(!av(L)){al(V,"Module ID must be a string.");return F;}else{if(!af[L]){al(V,"No module information for module ("+L+"), couldn't signal ("+aD+")");return F;}}aF=aF||[];var aK=F,A=af[L],aH=A.module,aG=A[aA],aE=A.api,aI=aF[0],aB=A.handlers,Y,aJ,aC;if(aG){if(aD==y||aD==ag){Y=aE.getViewNode(aF[0]);aC=aH.viewevents||[];if(!aB[aI]){aB[aI]=[];}if(aD==y){if(aC.length){if(Y){ac.each(aC,function(aL){aB[aI].push(Y.on(aL,K.rbind(ai,i,L,aI)));});}else{al(V,"Module missing a node for '"+aI+"' view",{moduleId:L});}}}else{if(aB[aI]){aJ=aB[aI].pop();while(aJ){aJ.detach();aJ=aB[aI].pop();}}}}i.fire({type:"modulesignal",signal:aD,moduleId:L,args:aF});aD="on"+aD;if(aH[aD]){aK=aH[aD].apply(aH,aF);if(aq(aK)){}else{aK=F;}}else{}}else{}return aK;}function u(){return U;}function Z(A){return G(af[A])?X:af[A].api;}function q(A){return G(af[A])?X:af[A][n][I]||X;}function m(A){return U[aw][A];}function e(L,A){return R(ay).getString(L,A);}function k(A,L){return W[L]?W[L].getViewDirection(A):X;}function ax(A,L){return W[L]?W[L].getViewNode(A):X;}function c(A){ar[A.name]=A;}function C(A){return o(ar,A);}function aa(A){return !!af[A];}function ad(aF){var Y=aF[aw],L=aF.mods,aC=Y.id,aE=R(ay),aB=YModules[Y.ns],A,aD;if(af[aC]){A=af[aC].config;ac.each(["strs","data","prefs"],function(aG){if(!A[aG]){A[aG]={};}K.mix(A[aG],aF[aG],F);});A.mods=aF.mods;}else{af[aC]={config:aF,api:K.ModuleApi(i,aF),started:p,handlers:{}};aE.setLoaded(aF[J]);}aE.setStrings(Y.type,aF.strs);if(a(L)){ac.each(L,ad);}if(av(Y.parentId)){aD=af[Y.parentId].config;if(!a(aD.mods)){aD.mods=[];}if(ac.indexOf(aD.mods,aF)==-1){aD.mods.push(aF);}}if(Y.trusted&&aB&&a(aB.services)){ac.each(aB.services,c);}}function v(L){var A=af[L];if(A){if(A[aA]){al("unregisterModule","Module "+L+" must be stopped before being unregistered.",{moduleId:L});}ac.each(b(L),v);delete af[L];}else{}}function S(L,aC){var aB=R("transport"),Y=aC.success||function(){},A=aC.scope||X;aC.success=function(aD,aE){ad(aD.mod);aD.data=aD.data||{};aD.data.moduleId=aD.mod.props.id;delete aD.mod;Y.call(A,aD,aE);};aB.makeRequest(K.merge({type:"loadmodule"},L),aC);}function z(A){W[A.name]=A.create(i);}function d(A){return o(W,A);}function au(L){var A=[];an.each(af,function(Y,aB){if(L(aB)){A.push(aB);}});return A;}function s(){return au(function(){return F;});}function b(aB){var L=af[aB],Y=L?L.config.mods:X,A=[];if(U&&a(Y)){ac.each(Y,function(aC){A.push(aC.props.id);});}return A;}function g(L,Y){var A=[];ac.each(Y,function(aB){A.push(af[aB].config);});af[L].config.mods=A;}function x(A){return af[A]&&!!af[A][aA];}function r(A){ah.push(A);ac.each(b(A),r);}function j(A,Y,L){if(av(A)){A=[A];Y=(aq(Y)?Y:p);}else{if(A instanceof Array){Y=(aq(Y)?Y:F);}else{return;}}if(Y){ac.each(A,r);if(ak===X){ak=P(0,X,l,[L]);}}else{ac.each(A,function(aB){ab(aB,L);j(b(aB),Y,L);});}}function am(A){var Y=R("transport"),L;if(av(A)){A=[A];}ac.each(A,function(aB){var aC=af[aB];Y.abortModuleRequests(aB);an.each(W,function(aD,aE){i.closeView(aB,aE);});if(x(aB)){f(aB,"destroy");aC[aA]=p;aC.module=X;H(aB);i.fire({type:"modulestop",moduleId:aB});L=b(aB);if(a(L)){am(L);}}});}function M(){var A=s();am(A);ac.each(A,v);at=0;w.detachAll();w.fired=false;}i={error:al,getConfig:u,getModuleApi:Z,getModuleState:q,getProperty:m,getService:R,getString:e,getModules:s,getChildModules:b,setChildModules:g,queryModules:au,isStarted:x,start:j,stop:am,reset:M,broadcast:ap,listen:E,unlisten:H,navigate:az,signal:f,getViewDirection:k,getViewNode:ax,registerService:c,unregisterService:C,registerViewType:z,unregisterViewType:d,isModuleRegistered:aa,loadModule:S,registerModule:ad,unregisterModule:v};K.augment(i,K.EventTarget);w=i.publish("ready",{fireOnce:true});K.ModulePlatform={BaseViewType:{getViewDirection:function(){return X;},getViewNode:function(){return X;}},init:function(L,A){U=L||{};if(L){R(ay).setLoaded(U[J]);if(U.mods){ac.each(U.mods,function(Y){ad(Y);if(!Y[I]||!Y[I].defer){j(Y[aw].id,F,A);}});}at=1;this.fire({type:"init"});}}};ac.each(O,function(A){i[A]=function(){var Y=arguments,L=function(){var aE=arguments,aF=aE[0],aD=aE.length==3?[aF,aE[2]]:[aF],aC=W[aE[1]];return aC?aC[A].apply(aC,aD):p;};if(U.debug){return L.apply(this,Y);}else{try{return L.apply(this,Y);}catch(aB){al(A,aB,{moduleId:Y[0],view:Y[1]});}}};K.ModulePlatform.BaseViewType[A]=function(){return p;};});K.mix(K.ModulePlatform,i);K.namespace(Q);K[Q][B]={name:"moduleplatform",getService:function(A,Y){if(!Y){return A;}else{var L=A.getModuleApi(Y);return(L&&L.getProperty("trusted")?i:X);}}};K.ModulePlatform.registerService(K[Q][B]);},"1.0",{requires:["event-base"]});/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("resourcemgr",function(b){var t=null,i=true,c={},p={},r={},u={},s=t,l=t,m=0,v=t,d={},n=b.ModulePlatform,g=b.Object,k=b.Lang,e,h="MPServices",o="ResourceMgrProvider";function j(x){var w=u[x];if(!k.isUndefined(w)){w();delete u[x];}delete p[x];e.fire({type:"complete",target:e,id:x});}function q(w){if(w.data.js){b.use("*",b.bind(a,this,w));}else{a(w);}}function a(B){var C=B.data.id,A=B.data.pkgs,z=t,y,w;for(y=0,w=A.length;y<w;y++){z=A[y];r[z]=1;delete c[z];b.Object.each(p,function(x,D){if(x[z]){delete p[D][z];}if(f(D)){j(D);}},this);}}function f(w){return(b.Object.size(p[w])==0);}e={_clearAll:function(){r={};c={};},getString:function(x,w){return d[x+"_"+w]||t;},isLoaded:function(w){return !!r[w];},load:function(y,D){var w=m++,C={js:{urls:[],names:[]},css:{urls:[],names:[]}},x,E,A,z,B;if(D){u[w]=D;}p[w]={};b.Array.each(["js","css"],function(F){E=C[F];A=[];g.each(y[F],function(G,H){if(c[H]){c[H].push(w);p[w][H]=1;}else{if(!r[H]){c[H]=[w];p[w][H]=1;E.names.push(H);if(G.indexOf("http")!==0){if(l){A.push(G);}else{E.urls.push(s+G);}}else{E.urls.push(G);}}}});if(A.length>0){E.urls.unshift(l+A.join("&"));}});if(f(w)){j(w);}else{z=C.js.urls;B=C.css.urls;if(z.length||B.length){if(B.length){x=b.Get.css(B,{onSuccess:q,scope:this,data:{id:w,pkgs:C.css.names}});}if(z.length){x=b.Get.script(z,{onSuccess:q,scope:this,data:{id:w,js:true,pkgs:C.js.names}});}this.fire({type:"start",target:this,id:w});}}},setLoaded:function(w){if(w){g.each(w.js,function(x,y){r[y]=i;});g.each(w.css,function(x,y){r[y]=i;});}},setStrings:function(w,x){g.each(x,function(z,y){d[w+"_"+y]=z;});}};b.augment(e,b.Event.Target);b.namespace(h);b[h][o]={name:"resourcemgr",getService:function(x,w){if(!v){v=x;s=v.getProperty("libRoot");l=v.getProperty("comboRoot");}return w?t:e;}};if(n){n.registerService(b[h][o]);}},"1.0");/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
window.transportEval=function(code){return eval("("+code+")");};YUI.add("transport",function(W){var f="MPServices",N="TransportProvider",aC="transport",ao="POST",o="GET",w="proxyUrl",aM="proxyTimeout",x="DaliRequestWs",m="module",aE="cfg.dali.handler.ws",aN="cfg.maple_dali.handler.add",ac="INVALID_CRUMB",aD=aN,I=x,au="ok",am="post",r="pr",z="dt",q="rt",ak="default",ae="response",i="request",a="server",aA="browser",aa="crumb",av="abort",an="timeout",s=a,A="nocookies",U="badcrumb",y="badformat",u=2,aw=1,n=0,b=i,ar=ae,aK=av,L="failure",t="success",Q="failure",C="error",aB=15000,ab=1500,j=2,c=5,p="Gateway Timeout",Z=W.Lang,aG=Z.isString,ay=Z.isFunction,B=Z.isObject,S=Z.isUndefined,aL=Z.isNull,d=Z.isArray,P=Z.isNumber,aI=null,e=false,ad={},al=null,G=n,K=null,v={},l=W.ModulePlatform,h=/Content-Type\:\s([^\n]+)/,E=/boundary=([^\n\s]+)\;/,ag=/\{[^\n]+\}/,at=/Content-ID\:\s([0-9]+)/,O={tData:{},rData:{}};RequestBlackboard=function(){var Y={};var aO=1;return{create:function(aP){Y[aO]=aP;return aO++;},remove:function(aP){if(Y[aP]){delete (Y[aP]);return true;}else{return false;}},setProp:function(aR,aP,aQ){if(Y[aR]){Y[aR][aP]=aQ;}else{return false;}},getProp:function(aQ,aP){if(!S(Y[aQ])){return Y[aQ][aP];}else{return false;}},queryAll:function(aP){var aT=[];for(var aQ in Y){if(Y.hasOwnProperty(aQ)){var aS=Y[aQ];if(!S(aS)&&aP(Y[aQ])){Y[aQ].txId=aQ;var aR=Y[aQ];aT.push(Y[aQ]);}}}return aT;},getByTx:function(aQ){var aP=aQ;return this.queryAll(function(aR){if(aR.transactionId==aP){return true;}else{return false;}});},get:function(aP){return Y[aP];},reset:function(){aO=1;Y={};O={tData:{},rData:{}};},getSize:function(){if(aO===1){return 0;}var aQ=0;for(var aP in Y){aQ++;}return aQ;},_requestStore:Y};}();var aF=function(){var Y=[];return{enqueue:function(aO){return Y.push(aO);},next:function(){return Y.shift();},peek:function(){return Y[0];},getSize:function(){return Y.length;},reset:function(){Y=[];}};}();function H(){l=W.ModulePlatform;aI=null;RequestBlackboard.reset();aF.reset();aj.reset();al=R;ad[m]=aH;ad[x]=ax;G=n;if(ay(e.cancel)){e.cancel();}}function T(){return new Date();}var ah={disable:function(Y){G=Y?u:aw;},enable:function(){if(G===u){af();}G=n;},isEnabled:function(){return(G==n);},setRequestFormatter:function(Y,aO){ad[Y]=aO;},setResponseFormatter:function(Y){al=Y;},abortRequest:function(aO,Y){if((!Y)||Y==RequestBlackboard.getProp(aO,"moduleId")){F(aO);this.fire(aK,{type:av,response:{}});return aq(aO,Q,av,"");}else{return false;}},abortModuleRequests:function(Y){var aO=RequestBlackboard.queryAll(function(aP){return aP.originId==Y;});W.Array.each(aO,function(aP){this.abortRequest(aP.txId,Y);},this);},isRequestPending:function(aP,aO){if(aO){var Y=RequestBlackboard.get(aP);return(B(Y)&&(Y.moduleId==aO));}else{return(RequestBlackboard.get(aP))?true:false;}},makeRequest:function(aP,aR,aQ){if(G!==aw){if(d(aP)&&aP.length>1){for(var aO=0,Y=aP.length;aO<Y;aO++){g(aP[aO],aR,aQ);}return null;}else{return g((d(aP)?aP[0]:aP),aR,aQ);}}else{return false;}},getMetrics:function(Y){return(B(O.rData[Y])?O.rData[Y]:null);},clearMetrics:function(aO){if(aO){delete (O.rData[aO]);}else{var Y=RequestBlackboard.get(aO);if(RequestBlackboard.getSize()>0){O.rData={};}else{O={tData:{},rData:{}};}}},_simulateResponse:function(aS,aP,aR){var aQ="";var Y=aj.simulateResponse;if(aP._raw){Y(1,{status:200,statusText:"OK",responseText:aP._raw});return;}if(aP._result){switch(aP._result){case"abort":Y(1,{status:0,statusText:aP._result},1);break;case"timeout":Y(1,{status:0,statusText:aP._result},1);break;case"ok":aQ='[{"txId":'+aS+',"status":200,"statusText":"OK", "data":';if(aP.html){aQ+='"html":"'+aP.html+'",';}aQ+='{"mods":[{"props":{}}]}}]';var aO='{"props":{}, "status":"OK", "resps":'+aQ+"}";Y(1,{status:200,statusText:"OK",responseText:aO},1);break;case C:if(aP._resultDetail&&aP._resultDetail=="badcrumb"){aQ="[]";Y(1,{status:200,statusText:"ok",responseText:'{"props":{}, "status":400, "statusText":"Bad Request", "resps":'+aQ+"}"},false);return true;}else{if(aP._resultDetail&&aP._resultDetail=="nocookies"){aQ="[]";Y(1,{status:200,statusText:C,responseText:'{"props":{}, "status":400, "statusText":"Bad Request", "resps":'+aQ+"}"},true);return true;}}aQ='[{"txId":'+aS+',"status":404,"statusText":"ERROR", "data":{"mods":[{"props":{}}]}}]';Y(1,{status:404,statusText:"File not Found",responseText:"<html><head><title>404</title></head><body><p>File not found</p></body></html>"},false);break;}}},_reset:H};function aJ(Y){var aQ=W.Object(Y.data);var aP=false;var aO=false;aQ.getResponseHeader=function(aV){if(!aP){this.responseHeader=aQ.responseHeader.replace("\r\n","\n");aO=true;var aS=aQ.responseHeader.split("\n");var aR=aS.length;aP={};for(var aT=0;aT<aR;aT++){var aU=aS[aT].split(": ");aP[aU[0]]=aU[1];}}return aP[aV];};aQ.getAllResponseHeaders=function(){if(!aO){this.responseHeader=aQ.responseHeader.replace("\r\n","\n");}return this.responseHeader;};return W.mix(Y,aQ);}var az=function(aO,Y){if(aO.data&&aO.data.responseText){return aJ(aO);}else{if(aO.data){if(aO.data.mods){aO.mods=aO.data.mods;aO.mod=aO.mods[0];delete (aO.data.mods);}if(aO.data.html){aO.html=aO.data.html;delete (aO.data.html);}if(aO.data.res){aO.res=aO.data.res;delete (aO.data.res);}}return aO;}};function R(aO,Y){return aO;}al=R;function F(Y){if(!RequestBlackboard.getProp(Y,"isBatch")){var aO=RequestBlackboard.getProp("transactionObject");if(B(aO)&&aO.isInProgress()){aO.abort();}}else{}}function aq(aW,aT,aY,aR){var aO=RequestBlackboard.get(aW);if(S(aO)){return false;}var aP=aO.response||{},aU=null,a4=null;aP.result=aY||au;aP.resultDetail=aR||"";aP.originId=aO.originId||null;aP.targetId=aO.targetId||aO.originId;if(aO.html){aP.html=aO.html;}ah.fire(ar,{type:ar,response:aP});if(B(aP.data)){a4=aP.data.res;aU=aP.data.mods;}if(B(aU)){if(aU[0].state&&aU[0].state.defer){if(!ap(aW,aU[0].state)){RequestBlackboard.remove(aW);aP.status=504;aP.statusText=p;aT=Q;}else{return;}}for(var a1=0,Y=aU.length;a1<Y;a1++){if(aU[a1].props&&aU[a1].props.id){aI.registerModule(aU[a1]);}}}aP=az(aP);aP=al(aP,aI);var aZ=aO.cb,aV,aQ=this,a3=null;if(O.tData[aO.transactionId]&&aY==au){a3=O.tData[aO.transactionId];O.rData[aW]={rt:a3.rt,pr:a3.pr,dt:0};}if(!S(aZ.argument)){aP.argument=aZ.argument;aV=aZ.argument;}if(ay(aZ[aT])){var aS=W.bind(aZ[aT],aZ.scope||this,aP,aV);if(B(a4)){var a2=aI.getService("resourcemgr"),aX=null;if(a3){aX=T();var a0=O.rData[aW];}a2.load(a4,function(){if(a3){a0.dt=T()-aX;}aS();});}else{aS();}}return RequestBlackboard.remove(aW);}function ap(aR,aQ){var Y=RequestBlackboard.get(aR);var aS=RequestBlackboard.getProp(aR,"retries");if((aS>(c))){return false;}var aO=aQ.retryCount||c;var aP=aQ.retryInterval;aS=(P(aS))?aS:0;if(aS<aO){++aS;W.Lang.later(aP,this,function(){RequestBlackboard.setProp((g(Y.requestObject,Y.cb,Y.originId)),"retries",aS);});RequestBlackboard.remove(aR);return true;}else{return false;}}function X(aP,aW,aQ){var Y=aP.txId;var aO=RequestBlackboard.get(Y);if(S(aO)){return;}var aR=true;var aU={data:aP.data};var aY,aV;var aS=aO.cb;if(aP.status==200||aP.status==201){aU.status=au;aU.result=au;aY=au;aR=false;}else{aU.status=C;aU.result=C;if(aP.status==400){var aT=aa,aX="Invalid crumb.";aV=U;aY=C;if(!window.navigator.cookieEnabled||aQ=="badcookie"){aT=aA;aV=A;aX="Cookies are disabled";}aI[C](aT,aX);}}RequestBlackboard.setProp(Y,ae,aU);aq(Y,((aR)?Q:t),aY,aV);}function J(Y,aR,aO){var aQ=null,aP=aO||false;if(Y.resps&&Y.resps.length===0){aQ=RequestBlackboard.getByTx(aR);W.Array.each(aQ,function(aU){var aT=aa,aS=U;if(!window.navigator.cookieEnabled||(aP===true)){aT=aA;aS=A;}aI[C](aT,"A crumb error occured: ",Y);aq(aU.txId,Q,C,aS);},this);}else{W.Array.each(Y.resps,function(aS){aI[C](aa,"A crumb error occured: ",Y);aS.status=400;X(aS,ioResponseObj);},this);}delete (v[aR]);}function V(bg,aX,aO){var aT=aO||false,a7=aX.status,bb=bg,a3="",a1=C;if(a7!=200&&a7!=201&&a7!=au){if(a7===0){a1=(aX.statusText==an)?an:av;}else{a3=a;aI[C](a,"A server error occured: ",{responseObject:aX});}var a2=RequestBlackboard.getByTx(bb);W.Array.each(a2,function(bc){if(O.rData[bc.txId]){delete (O.rData[bc.txId]);}aq(bc.txId,Q,a1,a3);});}else{O.tData[bg].startParse=T();var aZ=aX.responseText;var be=aX.getResponseHeader("Content-Type");if(be.indexOf("Multipart/Related")!==-1){var a0=E.exec(be),aQ=aX.responseText.split("--"+a0[1]),ba=aQ.length;for(var a9=1;a9<ba;a9++){var aP=aQ[a9],a6=h.exec(aP),aS=a6[1];if(aS.match(/application\/json/)){var aY=aP.match(ag)[0];aZ=aY;}else{if(aS.match(/text\/html/)){var bh=at.exec(aP),bd=bh[1],aR=aP.substring(aP.search(/\n\n/));aR=Z.trim(aR);RequestBlackboard.setProp(bd,"html",aR);}}}}var aV;try{aV=window.transportEval(aZ);}catch(bf){aI[C](a,"A parse error occured: "+bf.message,bf);var a5=RequestBlackboard.getByTx(bg);W.Array.each(a5,function(bc){aq(bc.txId,Q,C,y);},this);return;}if(!B(aV)){result=C;resultDetail=y;aI[C](a,"A parse error occured: ",aX);var aW=RequestBlackboard.getByTx(bg);W.Array.each(aW,function(bc){aq(bc.txId,Q,result,resultDetail);},this);return;}switch(aV.status){case ac:try{K.dali.crumb=aV.props.dali.crumb;}catch(a8){J(aV,bg,badcoookie);return;}var aU=v[bg];if(S(aU.cfg.retries)){aU.cfg.retries=1;}else{++aU.cfg.retries;}if(aU.cfg.retries<j){var Y=k(aU.cfg,aU.forcepost);var a4=RequestBlackboard.getByTx(bg);W.Array.each(a4,function(bc){bc.transactionId=Y.id;},this);delete (v[bg]);}else{J(aV,bg,aO);}break;case 400:J(aV,bg,aO);break;default:delete (v[bg]);O.tData[bg].pr=T()-O.tData[bg].startParse;W.Array.each(aV.resps,function(bc){X(bc,aX,aT);},this);break;}}}var aj=function(){var aP=null,aO={};function Y(aU,aT,aR){var aS=(new Date())-aO[aU];O.tData[aU]={rt:aS,pr:null};V(aU,aT,aR);}function aQ(aR){aO[aR]=new Date();}return{execute:function(aT,aW,aX){if(!aP){var aV=aI.getProperty(aM);if(!S(aV)){aP=aV;}else{aP=aB;}}var aS=am+"="+encodeURIComponent(aW);aT=(aX==o)?D(aT,"&__r="+new Date().getTime()):aT;var aR={method:aX,data:aS,on:{success:Y,failure:Y,start:aQ},timeout:aP};var aU=W.io(aT,aR);return aU;},simulateResponse:function(aT,aR,aS){aR.getResponseHeader=function(){return"";};if(aS){Y(aT,aR,true);}else{Y(aT,aR,false);}},reset:function(){aO={};v={};}};}();function D(Y,aO){return Y+((Y.indexOf("?")==-1)?"?":"&")+aO;}var ax=function(Y){var aP=aE,aQ=Y.batchable||false;if(S(Y.method)){Y.method="get";}var aO=false;switch(Y.method.toUpperCase()){case ao:aO=true;var aR=Y.data;if(!aG(aR)){aI[C](aC,"data must be a string");}else{Y.data=aR;}break;case (o||"DELETE"):if(Y.data!==undefined&&aG(Y.data)){Y.url=D(Y.url,Y.data);}break;default:}return{handler:aP,data:Y,batchable:aQ,forcepost:aO,targetId:Y.url};};var aH=function(aQ,aR,Y){var aO=aQ.args||{};var aP=aQ.moduleId||null;aO.moduleId=aP;if(aO.maple){aO.maple.module=aP;}else{aO.maple={module:aP};}return{handler:aN,data:aO,batchable:aQ.batchable||false};};ad[m]=aH;ad[x]=ax;function M(aQ,aP){var aO=aP.requestObject;var Y=aO.type||I;aO=(ay(ad[Y]))?ad[Y](aO,aP.moduleId,aI):aO;aO.txId=aQ;if(Y==x&&S(aP.targetId)){aP.targetId=aO.targetId;}if(S(aO.handler)){aO.handler=aD;}return aO;}function g(aO,Y,aR){var aP={requestObject:aO,cb:Y,moduleId:aR,originId:aR};if(aO.moduleId){aP.targetId=aO.moduleId;}var aQ=RequestBlackboard.create(aP);if(aO.batchable!==true&&G===n){af(aQ);}else{aF.enqueue(aQ);if(aO.batchable===true){if(!e){e=W.later(1,this,af);}else{e.cancel();e=W.later(1,this,af);}}else{if(G===n){af();}}}return aQ;}function k(aR,aS){var aO=aI.getProperty(w);if(aL(K)){K={};K.dali=aI.getProperty("dali")||{};}var aP=W.JSON.stringify({reqs:aR,props:K});var Y="GET";if((encodeURIComponent(aP).length>ab)||aS){Y="POST";}var aQ=aj.execute(aO,aP,Y);v[aQ.id]={ioObj:aQ,cfg:aR,forcepost:aS};return aQ;}function af(aV){var aO=false;var aW=[];var aS=[];var aU=false;if(aV){var aT=RequestBlackboard.get(aV);ah.fire(b,{type:b,request:aT.requestObject,originId:aT.originId});var Y=M(aV,aT);aW.push(Y);if(Y.forcepost===true){aU=true;}RequestBlackboard.setProp(aV,"isBatch",false);aS[0]=aV;}else{if(ay(e.cancel)){e.cancel();}var aX=aF.next();while(aX){var aQ=RequestBlackboard.get(aX),aR=false;if(aQ){ah.fire(b,{type:b,request:aQ.requestObject,originId:aQ.originId});aQ=M(aX,aQ);if(aQ.batchable!==true){if(aQ.forcepost===true){aR=true;}tx=k([aQ],aR);RequestBlackboard.setProp(aX,"transactionId",tx.id);RequestBlackboard.setProp(aX,"transactionObject",tx);aO=true;}else{if(aQ.forcepost===true){aU=true;}aW.push(aQ);aS.push(aX);}}aX=aF.next();}}if(aW.length>=1){var aP=k(aW,aU);W.Array.each(aS,function(aY){RequestBlackboard.setProp(aY,"transactionId",aP.id);RequestBlackboard.setProp(aY,"transactionObject",aP);aO=true;});}}function ai(){RequestBlackboard.reset();aF.reset();aj.reset();O={tData:{},rData:{}};}W.on("unload",ai,window);W.augment(ah,W.Event.Target);W.namespace(f);W[f][N]={name:"transport",getService:function(aO,Y){if(Y){return null;}if(!aI){aI=aO;}return ah;}};if(l){l.registerService(W[f][N]);}},"1.6.1",{requires:["event","io"]});/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("metro_dali",function(b){var a=b.ModulePlatform;a.subscribe("init",function(){var f=a.getService("transport"),e=0,d="cfg.maple_dali.handler.add",c="cfg.maple_dali.handler.refresh";f.setResponseFormatter(function(g){if(g.mod){g.data=g.mod.data;}if(g.data){delete g.data.maple;}return g;});f.setRequestFormatter("arcade",function(h,i){var g=b.mix({},h),j=h._id;delete g.type;if(!j){j=i;}if(h._type){j=h._type;}return{handler:c,data:{maple:{module:j,ba:b.merge(g,{_txnid:e++,_mode:"json",_id:j,_container:0,chrome:"false"})}}};});f.setRequestFormatter("loadview",function(k,j){var g=b.mix({},k),i=a.queryModules(function(p){var o=a.getModuleApi(p);return o&&o.getProperty("type")=="pa";})[0],m,n=k.moduleId,h=n,l=a.getModuleApi(n);switch(g.view){case"pa":g={handler:c,data:{maple:{module:i,ba:{_action:"show",_subAction:"single",modId:n,chrome:(g.chrome?"true":"false"),_txnid:e++,_mode:"json",_id:i,_container:(g.chrome?1:0),data:(g.data?g.data:null),cpos:l.getProperty("cpos")||undefined,pointer:(l.isViewOpen("default")||l.isViewOpen("edit"))?1:undefined}}},batchable:true};break;case"default":if(g.chrome){if(i){m=a.queryModules(function(q){var p=a.getModuleApi(q),o=p&&p.getProperty("type");return o=="pacontainer";})[0];h=m;}g={handler:d,data:{maple:{module:h,ba:{_action:"show",chrome:(g.chrome?"true":"false"),_txnid:e++,_mode:"json",_id:h,modId:n,_container:(g.chrome?1:0),view:"default"}}}};break;}default:g={handler:c,data:{maple:{module:n,ba:{_action:"show",_subAction:g.view=="default"?undefined:g.view,view:g.view,_txnid:e++,_mode:"json",_id:n,_container:(g.chrome?1:0),chrome:(g.chrome?"true":"false")}}}};break;}delete g.moduleId;delete g.type;return g;});f.setRequestFormatter("module",function(g,h){var i=g.moduleId;if(!i){i=h;}return{handler:c,data:{maple:{module:i,ba:b.merge({_txnid:e++,_mode:"json",_id:i,_container:0},g.args)}}};});});},"1.0",{requires:["transport"]});/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("module_api",function(a){a.ModuleApi=function(d,i){var h=i.props,f=a.Lang.isUndefined,b=h.id,j=i.prefs||{},g=null,c=["broadcast","listen","unlisten","closeView","getViewNode","getViewDirection","isViewOpen","navigate","openView","refreshView","setView"],e={getContextData:function(k){var m=i.data,l;if(m){l=(k?m[k]:m);}return(f(l)?g:l);},getId:function(){return b;},getProperty:function(k){var l=h[k];return f(l)?g:l;},getString:function(k){return d.getString(h.type,k);},getPref:function(k){var l=j[k];return f(l)?g:l;},setPref:function(k,l){var m=d.getService("transport");j[k]=l;if(m){m.makeRequest({type:"setpref",prefName:k,prefValue:l,moduleId:b},g,b);return true;}else{return false;}},getService:function(k){return d.getService(k,b);},error:function(k,l){d.error("module",k,a.merge((l?l:{}),{moduleId:b}));},abortRequest:function(k){var l=d.getService("transport");return !!(l&&l.abortRequest(k,b));},isRequestPending:function(k){var l=d.getService("transport");return !!(l&&l.isRequestPending(k,b));},makeRequest:function(k,m){var l=d.getService("transport");return(l?l.makeRequest(k,m,b):-1);}};a.Array.each(c,function(k){e[k]=function(){var l=a.Array(arguments,0,true);l.unshift(b);return d[k].apply(d,l);};});return e;};},"1.0");/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("yui_service",function(d){var b=d.ModulePlatform,a="MPServices",c="YUIProvider";if(d.Plugin&&d.Plugin.NodeFX){d.Node.plug(d.Plugin.NodeFX);}d.namespace(a);d[a][c]={name:"yui",getService:function(e,f){return d;}};if(b){b.registerService(d[a][c]);}},"1.0");/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("metro_viewtype",function(d){var c=null,b=false,a=true;d.namespace("Metro");d.Metro.createViewType=function(l,f){function k(p,o){return f.signal(p,o,[l]);}function j(o){return(o=="fp"||o=="toolbar")?d.one("body"):d.one("#"+l+"-"+o+"-bd");}function e(p){var o=j(p);return o?o.getStyle("direction"):c;}function i(q,p){var o=q.targetId,r=p?p.callback:c;this.setView(o,q.html);if(d.Lang.isFunction(r)){r(o,l);}}function n(o){return j(o)!=c;}function m(p,o,s,q){p=d.Array(p);var r=[];d.Array.each(p,function(t){r.push({type:"loadview",view:l,moduleId:t,chrome:o,data:q});});return f.getService("transport").makeRequest(r,s);}function h(p,r){var q=[],o=a;p=d.Array(p);if(p.length){d.Array.each(p,function(s){if(n(s)){var t=k(s,"viewrefresh");if(t){q.push(s);}}else{o=o&&b;}});if(o){this.loadView(q,false,{success:d.bind(i,this)},r);}}else{o=b;}return o;}function g(p,o){if(n(p)){k(p,"viewunload");j(p).set("innerHTML",o);this._afterSetView(p,o);k(p,"viewload");return a;}else{return b;}}return d.merge(d.ModulePlatform.BaseViewType,{_afterSetView:function(){},getViewDirection:e,getViewNode:j,isViewOpen:n,loadView:m,refreshView:h,setView:g});};},"1.0");/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("default_viewtype",function(c){var m=c.ModulePlatform,h=null,j=false,g=true,k=c.Lang,o=c.DOM,b=j,i={},l={},d={},e,n="default",a="MPViewTypes",f="DefaultViewTypeProvider";c.on("unload",function(){b=g;},window);c.namespace(a);c[a][f]={name:n,create:function(r){function u(B,C,E){var G=r.getModuleApi(B),A=G.getProperty("detailUrl"),F,K,z,D,I,H=j,J=r.queryModules(function(N){var M=r.getModuleApi(N),L=M&&M.getProperty("type");return L=="pacontainer";})[0];switch(C){case"badcrumb":E=r.getProperty("crumbErrorHtml");H=g;break;case"nocookies":E=r.getProperty("cookieErrorHtml");break;default:if(!E){E=c.Lang.substitute(r.getProperty("modErrorHtml"),{message:r.getString("fp","STR.MODULE.ERROR_FALLBACK_TEXT"),name:G.getProperty("title"),img:G.getProperty("icon"),title:G.getProperty("title"),url:G.getProperty("detailUrl")});}}F=E.indexOf('id="default-'+B+'"')>-1?E:c.Lang.substitute(r.getProperty("modChromeHtml"),{html:E,type_name:G.getProperty("type"),view_name:"error"});K=E.indexOf('id="default-'+J+'"')>-1?F:c.Lang.substitute(r.getString("pa","pacontainerHtml"),{html:F,title:G.getProperty("title")});z=o.create(K);if(!A){o.addClass(z,"no-link");}if(H){D=o.create('<p class="oops"><a href="'+window.location.href+'" class="cta-btn">'+r.getString("pa","STR.OK")+"</a></p>");}else{if(e!=B){D=o.create('<p class="oops"><button class="cta-btn pa-mod-err-retry">'+r.getString("pa","STR.TRY_AGAIN")+"</button></p>");}}if(D){I=c.Selector.query(".oops-msg",z,g);if(I){I.appendChild(D);}}e=B;return z;}function v(A,z){if(k.isFunction(A)){A(z,n);}}function p(A){var z=r.getService("pa");return !!(z&&z.isPAModule(A));}function x(A,z){return r.signal(A,z,[n]);}function t(B){if(p(B)){var z=r.getModuleApi(B),C=z.getProperty("type"),A=r.getString("pa","STR.PA.DISCLAIMER"),D;if(A&&!z.getProperty("trusted")&&C!="yap"){D=c.one("#default-"+B+"-ft");if(D){D.set("innerHTML",A);}}}}function q(D,A){var C=r.getService("pa"),E=C.getPacontainerId(),B=r.getService("metrics"),z;if(B){B.start("rv",{moduleId:D});}z=o.create(A);if(z&&!z.length){if(!r.isStarted(E)){r.start(E);}C.setChild(z,D);t(D);C.setModuleLoading(j);x(E,"viewload");i[D]=z;}else{r.error("loadview","Invalid HTML received",{moduleId:D});}if(B){B.stop("rv");}}function w(B,C,z){var A=r.getService("pa"),D=A.getPacontainerId();if(!r.isStarted(D)){r.start(D);}A.setChild(u(B,C,z),B,C);A.setModuleLoading(j);x(D,"viewload");}function y(E,B){var C=E.targetId,A=l[C],H=B?B.callback:h,G=r.getService("metrics"),D=r.getService("transport"),F=E.html,z;if(G){z=D.getMetrics(A);if(z){if("rt" in z){G.set("rt",z.rt);}if("pr" in z){G.set("pr",z.pr);}if("dt" in z){G.set("js",z.dt);}}D.clearMetrics();G.stop("ov");}q(C,F);delete l[C];delete d[C];v(H,C);}function s(C,B){if(!b){var A=C.targetId,D=B?B.callback:h,z;d[A]=1;delete l[A];if(C.result!="abort"){z=r.getService("metrics");if(z){z.clear("ov");}r.error("loadview","Server error while loading default view.",{moduleId:A,html:(C?C.html:""),viewName:n});w(A,C.resultDetail,C.html);v(D,A);}}}return c.merge(c.Metro.createViewType(n,r),{closeView:function(B,D){var A=r.getService("pa"),C=A&&A.getPacontainerId(),z=(A&&p(B))?C:B;if(this.isViewOpen(B)&&x(z,"viewclose")){x(z,"viewunload");if(z==C){delete i[B];A.clearChild(B);}v(D,B);return g;}else{if(k.isNumber(l[B])){r.getService("transport").abortRequest(l[B]);delete l[B];}}return j;},hideView:function(z){if(this.isViewOpen(z)){this.getViewNode(z).get("parentNode").setStyle("display","none");return g;}return j;},openView:function(B,D){var A=r.getService("pa"),C=A&&A.getPacontainerId(),z;if(A&&p(B)&&!this.isViewOpen(B)&&x(C,"viewopen")){z=r.getService("metrics");if(z){z.start("ov",{moduleId:B});}l[B]=this.loadView(B,g,{success:y,failure:s,argument:{moduleId:B,callback:D}});return l[B]!=-1;}else{return j;}},showView:function(z){if(this.isViewOpen(z)){this.getViewNode(z).get("parentNode").setStyle("display","");return g;}return j;},_afterSetView:function(A,z){t(A);}});}};if(m){m.registerViewType(c[a][f]);}},"1.0");/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("edit_viewtype",function(c){var o=null,l=false,h=true,j=c.ModulePlatform,r=o,f=l,q,d=o,e={},g="viewload",n="edit",i="MPViewTypes",a="EditViewTypeProvider";function m(t,s){return r.signal(t,s,[n]);}function b(u,t){var s=u.targetId,v=t?t.callback:o;delete e[s];f=l;d=c.DOM.create(u.html);if(d&&!d.length){r.hideView(s,"default");r.getViewNode(s,"default").get("parentNode").insert(d,"after");m(s,g);if(c.Lang.isFunction(v)){v(s,n);}}else{r.error("loadview","Invalid HTML received",{moduleId:s});}}function p(t){var s=r.getModuleApi(t);return c.Lang.substitute(r.getProperty("modErrorHtml"),{message:r.getString("fp","STR.MODULE.ERROR_FALLBACK_TEXT"),name:s.getProperty("title"),img:s.getProperty("icon"),title:s.getProperty("title"),url:s.getProperty("detailUrl")});}function k(v,u){var t=v.targetId,w=u?u.callback:o,s=p(t);r.getViewNode(t,"default").set("innerHTML",s);r.error("loadview","Server error while loading edit view.",{moduleId:t,html:(v?v.html:""),viewName:n});delete e[t];if(c.Lang.isFunction(w)){w(t,n);}}q={closeView:function(s,u){if(this.isViewOpen(s)){var t=c.one("#edit-"+s).getDOMNode();t.parentNode.removeChild(t);r.showView(s,"default");if(c.Lang.isFunction(u)){u(s,n);}return h;}else{if(c.Lang.isValue(e[s])){r.getService("transport").abortRequest(e[s]);delete e[s];}else{return l;}}},getViewNode:function(s){return c.Node.one("#edit-"+s+"-bd");},isViewOpen:function(s){return this.getViewNode(s)!=o;},loadView:function(s,t){f=h;return r.getService("transport").makeRequest({type:"loadview",view:"edit",moduleId:s,chrome:true},t);},openView:function(s,t){if(!this.isViewOpen(s)&&!f){e[s]=this.loadView(s,{success:b,failure:k,argument:{moduleId:s,callback:t}});return e[s]!=-1;}else{return l;}},refreshView:function(s){return l;},setView:function(t,s){if(this.isViewOpen(t)){m(t,"viewunload");this.getViewNode(t).set("innerHTML",s);m(t,g);return h;}else{return l;}},showView:function(s){return l;}};c.namespace(i);c[i][a]={name:n,create:function(s){r=s;return q;}};if(j){j.registerViewType(c[i][a]);}},"1.0");/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
if(typeof YAHOO=="undefined"){YAHOO={};}if(!YAHOO.ULT){YAHOO.ULT={};}if(!YAHOO.ULT.BEACON){YAHOO.ULT.BEACON="http://geo.yahoo.com/t";}if(!YAHOO.ULT.IMG){YAHOO.ULT.IMG=new Image();}YAHOO.ULT.SRC_SPACEID_KEY="_S";YAHOO.ULT.DEST_SPACEID_KEY="_s";YAHOO.ULT.YLC_LIBSRC=2;YAHOO.ULT.CTRL_C="\x03";YAHOO.ULT.CTRL_D="\x04";YAHOO.ULT.BASE64_STR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789._-";(function(){YAHOO.ULT.track_click=function(c,g){if(!c||!g){return c;}g._r=YAHOO.ULT.YLC_LIBSRC;var h=[];var d=0;for(var b in g){var a=g[b];if(typeof(a)=="undefined"){a=g[b]="";}if(b.length<1){return c;}if(b.length>8){return c;}if(b.indexOf(" ")!=-1){return c;}if(YAHOO.ULT.has_ctrl_char(b)||YAHOO.ULT.has_ctrl_char(a)){return c;}h[d++]=b;}h=h.sort();var e=[];for(d=0;d<h.length;d++){e[d]=h[d]+YAHOO.ULT.CTRL_C+g[h[d]];}e=e.join(YAHOO.ULT.CTRL_D);if(e.length<1||e.length>1024){return c;}e=";_ylc="+YAHOO.ULT.encode64(e);d=c.indexOf("/*");if(d==-1){d=c.indexOf("/?");}if(d==-1){d=c.indexOf("?");}if(d==-1){return c+e;}else{return c.substr(0,d)+e+c.substr(d);}};YAHOO.ULT.beacon_click=function(c,b){if(!b){b=YAHOO.ULT.IMG;}if(c){var a=YAHOO.ULT.track_click(YAHOO.ULT.BEACON,c);a+="?t="+Math.random();b.src=a;}return true;};YAHOO.ULT.has_ctrl_char=function(b){for(var a=0;a<b.length;a++){if(b.charCodeAt(a)<32){return true;}}return false;};YAHOO.ULT.encode64=function(c){var a="";var k,h,f="";var j,g,e,d="";var b=0;do{k=c.charCodeAt(b++);h=c.charCodeAt(b++);f=c.charCodeAt(b++);j=k>>2;g=((k&3)<<4)|(h>>4);e=((h&15)<<2)|(f>>6);d=f&63;if(isNaN(h)){e=d=64;}else{if(isNaN(f)){d=64;}}a=a+YAHOO.ULT.BASE64_STR.charAt(j)+YAHOO.ULT.BASE64_STR.charAt(g)+YAHOO.ULT.BASE64_STR.charAt(e)+YAHOO.ULT.BASE64_STR.charAt(d);k=h=f="";j=g=e=d="";}while(b<c.length);return a;};})();/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("instrumentation",function(d){var L=null,Z=false,K=true,b=d.ModulePlatform,a=L,aa=L,ab=L,t=L,H=L,I=Z,r=L,Q=L,o=Z,f=Z,W=Z,G=K,k=Z,l=Z,J=L,e={},s,U,u=L,h="getProperty",C="data-b",S="aria-disabled",X="data-ylk",i="data-action",B="data-action-outcome",M="MPServices",V="InstrumentationProvider";function p(ae){var Y=new Image();Y.id=d.guid();e[Y.id]=Y;Y.onload=Y.onerror=function(){delete e[this.id];};if(ae){Y.src=ae;}return Y;}function A(ag){var ae=ag.hasAttribute(C)?ag:ag.ancestor(function(ah){return ah.hasAttribute(C);}),Y=ag.getAttribute(S)=="true",af=ae?ae.getAttribute(S)=="true":Z;if(ae&&!ag.hasClass("nobeacon")&&!Y&&!af){return ae.getAttribute(C);}else{return L;}}function w(Y){var ae,af=a[h]("ywa.rapid.enabled.modules")||{};if(Q&&d.Lang.isFunction(u.refreshModule)){ae=d.one(Y);if(ae){if(af[Y.get("id")]||W===K){u.refreshModule(ae.generateID());}}}}function v(Y){var ae;if(Q){if(o&&d.Lang.isFunction(u.refreshModuleAsRichView)){ae=d.one(Y);if(ae){u.refreshModuleAsRichView(ae.generateID());}}else{w(Y);}}}function c(Y){if(Q){u.addModules(Y);}}function n(af,ae,Y){if(u&&u.beaconLinkViews){u.beaconLinkViews(af,ae,Y);}}function x(Y){if(u&&u.beaconPerformanceData){u.beaconPerformanceData(Y);}}function ac(Y,af){if(Q&&d.Lang.isFunction(u.addModules)){var ag=d.one(Y),ah,ae={};if(ag){ah=ag.generateID();ae[ah]=af;u.addModules(ae);}}}function N(Y){if(Q){if(o&&d.Lang.isFunction(u.addModulesAsRichView)){u.addModulesAsRichView(Y);}else{c(Y);}}}function F(Y){if(Q&&d.Lang.isFunction(u.isModuleTracked)){var ae=d.one(Y);if(ae){return u.isModuleTracked(ae.generateID());}}}function E(Y){if(Q&&d.Lang.isFunction(u.removeModule)){var ae=d.one(Y);if(ae){return u.removeModule(ae.generateID());}}}function z(ae){if(!ae||!ae.hasAttribute(X)){return L;}var af={},ag=ae.getAttribute(X),Y;if(ag){Y=ag.split(";");d.Array.each(Y,function(ah){var ai=ah.split(":");if(ai[0]&&ai[1]){af[ai[0]]=ai[1];}});if(ae.hasAttribute(i)){af.action=ae.getAttribute(i);}if(ae.hasAttribute(B)){af.outcm=ae.getAttribute(B);}}return af;}function m(af,Y){var ae=p(),ag;if(!G&&!f){return;}if(af instanceof d.Node){af=A(af);}if(!af){return;}if(d.Lang.isObject(af)){ag=d.merge({_S:aa,test:ab},af);delete ag.action;delete ag.outcome;if(Y){YAHOO.ULT.BEACON=YAHOO.ULT.BEACON+";"+Y;}YAHOO.ULT.beacon_click(ag,ae);if(Y){YAHOO.ULT.BEACON=H;}}else{if(Y){af+=";"+Y;}ae.src=(t||YAHOO.ULT.BEACON)+";"+af+"?t="+(new Date()).getTime();}}function P(Y){if(!Q){return;}if(!u){return;}var ae;if(Y instanceof d.Node){ae=z(Y);}else{if(d.Lang.isObject(Y)){ae=Y;}}if(!d.Lang.isObject(ae)||!ae.action){return;}if(ae.action==="click"){u.beaconClick(ae.sec,ae.slk||"",ae.pos||0,ae,ae.outcome||ae.outcm||L);}else{u.beaconEvent(ae.action,ae,ae.outcome||ae.outcm||L);}}function D(ae,Y){m(ae,Y);P(ae);}function T(){var ae=window.location,Y;if(!d.Lang.isUndefined(window._comscore)){Y=p();Y.src=(ae.protocol==="https:"?"https://sb":"http://b")+".scorecardresearch.com/p?c1=2&c2=7241469&c4="+encodeURIComponent(ae.protocol+"//"+ae.host)+"&c5="+aa+"&ns_c=UTF-8&ns__t="+(new Date().getTime());}else{if(YAHOO.i13n&&d.Lang.isFunction(YAHOO.i13n.sendComscoreEvent)){YAHOO.i13n.sendComscoreEvent({c7:ae.href});}}}function y(af){if(I){return;}var ae=a.getProperty("ylp"),Y=p();if(!ae){return;}if(!af){return;}Y.src=(t||YAHOO.ULT.BEACON)+";"+ae+"?t="+(new Date()).getTime()+"&"+af;I=true;}function O(){var aj,ah=d.Object.getValue(window,["performance","timing"]),af=a[h]("tsrc"),ae=a[h]("err404"),Y=a[h]("errurl"),ai=a[h]("rapid.custom.perf.beacon"),ag={pt:1,mrkt:a[h]("intl"),authfb:a[h]("fbauthstate"),f:a[h]("hps"),rid:a[h]("requestId"),colo:a[h]("colo")};if(ae){ag.err=ae;}if(Y){ag.err_url=Y;}if(af){ag.tsrc=af;}if(ai&&ah){aj=ah.requestStart;ag.prfm1=ah.responseStart-aj;ag.prfm2=ah.responseEnd-aj;ag.prfm3=ah.domContentLoadedEventEnd-aj;ag.prfm4=+(new Date())-aj;}return ag;}function j(ae){if(r){return;}var Y=A(ae);if(Y){r=Y;}else{}}function q(){r=L;}function R(){return(r!==L);}function ad(){if(r){D(r);r=L;}}function g(){var Y=a[h]("addthis.beacon");if(Y){p(Y);}}s={fireBeacon:D,fireUltBeacon:m,fireYwaBeacon:P,getBeaconImage:p};U={collectData:j,fireBeacon:D,fireUltBeacon:m,fireYwaBeacon:P,getBeaconImage:p,fireComscoreBeacon:T,firePageParameterBeacon:y,clearPendingBeacons:q,firePendingBeacons:ad,hasPendingBeacons:R,getBeaconKeys:z,addModules:c,addModule:ac,beaconLinkViews:n,beaconPerformanceData:x,removeModule:E,isModuleTracked:F,addModulesAsRichView:N,refreshModule:w,refreshModuleAsRichView:v};d.namespace(M);d[M][V]={name:"instrumentation",getService:function(ai,ah){if(!a){var ag,ae,af,Y;a=ai;aa=a[h]("ultSpaceId");ab=a[h]("ywa.rapid.bucket.id");t=a[h]("ultBeaconHost");Q=!!a[h]("ywa.rapid.enabled");o=!!a[h]("ywa.rapid.richview.enabled");f=!!a[h]("ywa.rapid.ult.enabled");l=!!a[h]("rapid.init.beacon");k=!!a[h]("ywa.pageview.on.init");J=a[h]("custom.beacon.endpoint");if(YAHOO&&YAHOO.i13n&&J){YAHOO.i13n.beacon_server=J;}if(Q){if(typeof YMedia!=="undefined"&&typeof YMedia.rapid!=="undefined"){u=YMedia.rapid;G=Z;W=K;}else{YAHOO.i13n.YWA_CF_MAP={authfb:11,mrkt:12,pt:13,sec:18,slk:19,cpos:21,pkgt:22,ct:23,bpos:24,cat:25,dcl:26,rescode:27,sort:28,ilc:39,f:40,prfm1:41,prfm2:43,prfm3:44,prfm4:45,ft:51,v:52,sca:53,camp:54,code:55,elm:56,elmt:57,ad:58,tsrc:69,err:72,rspns:107,dir:108,grpt:109,mpos:110,itc:111,sp:115,tar:113,t1:121,t2:122,t3:123,t4:124,t5:125};YAHOO.i13n.YWA_ACTION_MAP={click:12,scrollup:15,hover:17,secview:18,hswipe:19,share:23,reauthfb:24,insert:28,flw:52,unflw:53,rpl:54,rt:55,fav:56,error:99,swp:103,drag:105,hvr:115,secvw:116};YAHOO.i13n.YWA_OUTCOME_MAP={share:23,navigate:25,top:26,hpset:27,open:29,fetch:30,end:31,rmct:32,login:33,close:34,filter:35,connect:36,itemdecl:37,setlayout:38,sort:39,entitydecl:40,undo:41,cueswipeview:42,cueauthview:43,cueloadview:44,cueinfoview:45,cueconnectview:46,msgview:47,authview:48,loadview:49,cuehpset:50,cuedcl:61,dclent:101,dclitm:102,svct:109,unsvct:110,rmsvct:117,slct:121,lgn:125,lgo:126,cnct:127,flagitm:129,unflagitm:130,flagcat:131,unflagcat:132,slctfltr:133,srch:134};G=!f;ag={client_only:!!a[h]("rapid.clientonly"),use_rapid:f,use_sampling:!!a[h]("ywa.rapid.sampling.enabled"),debug:!!a[h]("ywa.rapid.debug"),sampling_affects_ywa:!!a[h]("ywa.rapid.sampling.enabled"),sampling_range:a[h]("ywa.rapid.sampling.range"),spaceid:a[h]("ywa.rapid.space.id"),test_id:ab,pageview_on_init:k,track_right_click:!!a[h]("rapid.right.click"),apv:!!a[h]("rapid.add.pageview"),yql_host:a[h]("ywa.rapid.yql.host"),perf_navigationtime:a[h]("rapid.perf.navigationtime"),yql_path:a[h]("rapid.yql.path"),tracked_mods:a[h]("ywa.rapid.enabled.modules"),ywa:{project_id:a[h]("ywa.rapid.project.id"),host:a[h]("ywa.rapid.host")},keys:O(),nofollow_class:["rapidnofollow","video-inline"],webworker_file:a[h]("ywa.rapid.worker.path")};if(typeof YAHOO.i13n.Rapid!=="undefined"){if(l){Y=d.one("body");ae="//geo.yahoo.com/p?s="+a[h]("ywa.rapid.space.id")+"&test=scooby_qa_d&btype=rapidb&t="+Math.random();af=d.Node.create('<img class="D-n" src='+ae+"/>");Y.append(af);}u=new YAHOO.i13n.Rapid(ag);}else{u=new YAHOO.i13n.Track(ag);u.init();}}}if(t){YAHOO.ULT.BEACON=t;}H=YAHOO.ULT.BEACON;g();}return(!ah||a.getModuleApi(ah)[h]("trusted")?U:s);}};if(b){b.registerService(d[M][V]);}});/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("userinfo_service",function(g){var d=null,c=g.ModulePlatform,a=d,f,b="MPServices",e="UserInfoProvider";f={getDisplayName:function(){return a.getProperty("user");},isLoggedIn:function(){return !!a.getProperty("user");},isRecognized:function(){return !!a.getProperty("userRecognized");},getLocation:function(){var i={},l=a.getProperty("userLocation"),j=["zip","city","state","country","woeid","lat","lon"],h=j.length,k;if(l){while((k=j[--h])){i[k]=l[k]||null;}}return i;}};g.namespace(b);g[b][e]={name:"userinfo",getService:function(i,h){if(!a){a=i;}return f;}};if(c){c.registerService(g[b][e]);}},"1.0");/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("statemgr_service",function(b){var k=b.ModulePlatform,g="MPServices",m="StateMgrProvider",j="MSC",i="fpps",e="fpms",p="_page",l,h,c,d,r,o;function f(){var t=new Date();t.setFullYear(t.getFullYear()+1);return t;}function s(x,v,u){var w=h.getSub(x,v),t=null;if(w){t=c.parse(w)[u];}return t;}function a(z,w,t){var y=h.getSub(z,w),x,v,u;if(y){x=c.parse(y);delete x[t];v=c.stringify(x);u={expires:f(),domain:l,path:"/"};if(v=="{}"){h.removeSub(z,w,u);}else{h.setSub(z,w,v,u);}}}function q(y,u,t,w){var x=h.getSub(y,u),v=x?b.JSON.parse(x):{};v[t]=w;h.setSub(y,u,c.stringify(v),{expires:f(),domain:l,path:"/"});}function n(t){if(!d[t]){d[t]=r.getModuleApi(t).getProperty("trusted")?b.Object(o):{};b.mix(d[t],{getUserModuleState:function(u){return s(e,t,u);},removeUserModuleState:function(u){a(e,t,u);},setUserModuleState:function(u,v){q(e,t,u,v);},saveUserSetting:function(w,x,u){var v=k.getService("userinfo");if(v.isLoggedIn()){u.makeRequest({type:"module",moduleId:u.getId(),args:{_action:"save",_subAction:"userPrefSave",key:w,value:x,noups:1}},{});}else{this.setUserModuleState(w,x);this.update();}}});}return d[t];}o={isUpdated:function(){return !!h.get(j);},update:function(){h.setSub(j,"mod","1",{domain:l,path:"/"});},getUserPageState:function(t){return s(i,p,t);},removeUserPageState:function(t){a(i,p,t);},setUserPageState:function(t,u){q(i,p,t,u);}};b.namespace(g);b[g][m]={name:"statemgr",getService:function(u,t){r=u;h=b.Cookie;c=b.JSON;l=u.getProperty("cookieDomain")||b.config.win.location.hostname;if(!d){d={};}return !t?o:n(t);},destroy:function(){d=null;}};if(k){k.registerService(b[g][m]);}},"1.0");/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("arcade_transport",function(f){var M=null,ag=false,H=true,S,d=f.ModulePlatform,c=M,ah,i=encodeURIComponent,n=f.Lang,l=f.Object,w=f.Array,N,G,D,e,ab=ag,P={},ad={},ai=[],x,g=ag,u,o,X=0,aj=1,s=2,v=3,C=2048,af=131072,p="_status",Z="_txnid",U="POST",B="GET",h="getProperty",R="MPServices",ac="TransportProvider";function K(L,A){c.error("transport",L,A);}function W(O){var L=M,A;switch(O.type){case"moduleload":L={_action:"show",_create:1,_suid:O.contentId};break;case"setpref":L={_action:"save",_subAction:S,_type:"pref",modid:O.moduleId,_create:1};break;case"loadview":if(O.view=="pa"){A=c.queryModules(function(ak){var Y=c.getModuleApi(ak);return Y&&Y.getProperty("type")=="pa";})[0];L={_action:"show",_subAction:"single",modId:O.moduleId,_container:0,_id:A};}else{L={_action:"show",_subAction:O.view=="default"?S:O.view,_id:O.moduleId,_container:O.chrome?1:0};}break;case"arcade":case"module":L=O.args;L._container=O.chrome?1:0;L._id=O.moduleId;break;default:K("Request doesn't have a type.");break;}O=L?f.merge(L,O):f.mix({},O);delete O.type;delete O.moduleId;delete O.args;return O;}function J(L){var A=L.match(/^((?:\w+:\/\/)?[^#?]+)/);return(A&&n.isArray(A))?A[1]:"";}function aa(L){if(!L){return"";}var A=[];l.each(L,function(Y,O){if(n.isValue(Y)){if(!n.isString(Y)){Y=f.JSON.stringify(Y);}A.push(O+"="+i(Y));}});return A.join("&");}function E(O,am,al){if(!al){K("Proxy request: No module id given, unable to look up proxy signature.");}var ak=J(O.url),Y=c.getModuleState(al).proxy[ak],L,A;if(!Y){K("Proxy request: '"+O.url+"' has not been registered for proxying.");}L=G+"?url="+i(O.url)+"&.sig="+Y+"&.crumb="+N;A={method:O.method,data:O.bodyData,on:am,headers:O.headers};return f.io(L,A);}function b(al,aq,L){if(al.type=="xhr"){return E(al,aq,L).id;}D=D?D:"/jsal";var A=D,an={method:B,on:x},ak={_crumb:N,_mode:"json"},am=c[h]("passthru"),ap,ao,Y,O;if(n.isArray(al)){an.method=U;}else{al=[al];}if(e){ak.pgmode=e;ak.reqSource=e;}ak[Z]=new Date().getTime();w.each(al,function(at,ar){al[ar]=W(at);al[ar][Z]=ak[Z];});if(an.method==B){ap=f.merge(al[0],ak);ao=aa(ap);if(ao.length>2000){an.method=U;}else{A=D+"?"+ao;}}if(am){A+=(A.indexOf("?")>-1?"&":"?")+am;}if(an.method==U){an.data=aa(ak)+"&_json="+i(f.JSON.stringify(al));}Y=f.io(A,an);O=Y.id;P[O]={args:arguments,moduleId:L,conn:Y};if(aq){P[O].callback=aq;}return O;}function m(){if(n.isArray(o)){while(o.length>0){var A=o.shift();b.apply(this,A);}u.detach();u=o=M;}g=ag;}function j(A){g=H;if(A){o=[];u=f.on("unload",f.bind(m,this,H),window);}}function z(ak,Y,O){var L=Y.responseText,A;if(L){A=L.indexOf("<!--");if(A>0){L=L.substring(0,A);}}N=L;m();ab=ag;}function T(O,L,A){K("Unable to update crumb.");}function F(){if(ab){return ag;}ab=H;j(H);var A={success:z,failure:T,scope:this};f.io("/?_mode=html&_action=show&_type=pref&_create=1&_subAction=_cFetch",{method:B,on:A});}function r(O,Y,L){if(g){if(n.isArray(o)){var A=f.Array(arguments);o.push(A);return M;}return ag;}return b(O,Y,L);}function a(L){var A=(P[L]&&P[L].conn&&P[L].conn.isInProgress());return A;}function V(A){if(a(A)){P[A].conn.abort();}else{return false;}}function t(A){if(A&&P[A]&&P[A].args){r.apply(M,P[A].args);delete P[A];delete ad[A];return H;}return ag;}function k(ak,O,A){if(n.isUndefined(O)){O=H;}if(n.isFunction(ak)){ak(ak.argument,A);}else{var L=ak.scope||ak,Y=O?ak.success:ak.failure;if(Y){Y.call(L,A,ak.argument);}}}function y(Y,A,L){var O=P[Y].callback;if(O){k(O,L,A);}if(!n.isUndefined(ad[Y])){if(ad[Y]>1){ad[Y]-=1;}else{delete ad[Y];}}if(n.isUndefined(ad[Y])){delete P[Y];}}function Q(al,A){var L=A._errorCode,Y=A._error,ak=P[al].callback,O={message:Y,moduleId:P[al].moduleId};if(A[p]==aj){if(L==af){if(!ab){F();}t(al);}else{K(Y,O);if(O.moduleId){return;}}}if(ak){k(ak,ag,O);}}function ae(){var A=ai.shift(),O,L;if(A){O=A[Z];if(A[p]!=X){Q(O,A);}else{L=c.getService("resourcemgr");if(A.props&&A.props.id){c.registerModule(A);}if(A.res){L.load(A.res,f.bind(y,M,O,A));}else{y(O,A);}}if(ai.length){n.later(1,this,ae);}}}function I(O,L,A){setTimeout(function(){y(O,L,ag);},0);}function q(ak,Y,A){var O;try{O=f.JSON.parse(Y.responseText);}catch(L){}finally{if(!n.isArray(O)){I(ak,Y,A);return;}}w.each(O,function(am){if(am[p]!=X){Q(ak,am);return;}var al;if(am.response){al=am.response;}else{al=[am];}if(!ad[ak]){ad[ak]=0;}ad[ak]+=al.length;w.each(al,function(an,ao){an._partId=ao;an[Z]=ak;if(!an.data){an.data={};}an.data=f.merge(am.data,an.data);});ai=ai.concat(al);});if(ai.length){n.later(1,this,ae);}}ah={E_OK:X,E_FATAL:aj,E_GLOBAL:s,E_MODULE:v,EC_CRUMB_ERR:C,EC_CRUMB_STALE:af,disable:j,enable:m,isEnabled:function(){return !g;},makeRequest:r,abortRequest:V,isRequestPending:a,_reset:function(){ab=ag;P={};ad={};ai=[];o=M;m();}};x={success:q,failure:I,scope:this};f.namespace(R);f[R][ac]={name:"arcade_transport",getService:function(L,A){if(!c){c=L;N=c[h]("crumb");if(n.isUndefined(N)){N=c[h]("dali").crumb;}G=c[h]("proxyUrl");D=c[h]("requestUrlLite");e=c[h]("pgmode");}return A?M:ah;}};if(d){d.registerService(f[R][ac]);}},"1.0",{requires:["event","io"]});/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("tooltip_service",function(b){var m=b.ModulePlatform,n,d,e="MPServices",a="ToolTipProvider",i="hide",l="bottom",f="top",h=null,c="left",j="right",g="px";function k(p){var o;this.options=b.merge({position:{box:"b",arrow:"c"},msg:"<!-- empty -->",className:"y-tooltip-default",pointerClass:"y-glbl-universal",borderClass:"",parentNode:document.body,autohide:false,role:"alert",scrollIntoView:false},p);this.options.parentNode=b.one(this.options.parentNode);if(b.Lang.isArray(this.options.borderClass)){this.options.borderClass=this.options.borderClass.join(" ");}if(b.Lang.isArray(this.options.className)){this.options.className=this.options.className.join(" ");}if(b.Lang.isArray(this.options.pointerClass)){this.options.pointerClass=this.options.pointerClass.join(" ");}o="<div class='y-tooltip "+this.options.className+"'><div class='tooltip hide' role='"+this.options.role+"'><div class='content "+this.options.borderClass+"'></div><span class='"+this.options.pointerClass+" pointer'></span><div class='crnr-rt'></div><div class='crnr-rb'></div></div></div>";this.toolTipBody=b.Node.create(o);this.pointAtMe=h;this.toolTip=this.toolTipBody.one(".tooltip");this.content=this.toolTipBody.one(".content");this.pointer=this.toolTipBody.one(".pointer");this.autohideId=h;this.options.parentNode.insertBefore(this.toolTipBody,this.options.parentNode.get("firstChild"));if(this.options.autohide){this.autohideId=d.getService("autohide").register({targets:[this.toolTip],hide:b.bind(this.hide,this)});}}k.prototype={getNode:function(){return this.toolTipBody;},setContent:function(o){if(typeof(o)==="string"){this.content.set("innerHTML",o);}else{this.content.set("innerHTML","");this.content.appendChild(b.one(o));}return this.content;},positionToolTip:function(s,D){var u,A,z,w,t=D.msg,y=D.position.box,B=D.position.arrow,r=D.position.alignNode,q=this.toolTip,p=this.pointer,v,C,x=D.parentNode.getStyle("direction"),o=D.noMsgUpdate||false;if(x==="rtl"){if(y==="r"){y="l";}else{if(y==="l"){y="r";}}if(B==="l"){B="r";}else{if(B==="r"){B="l";}}}w=this.pointAtMe=b.one(s);if(r){r=b.one(r);}if(!o&&t){this.setContent(t);}u=b.DOM.region(b.Node.getDOMNode(w));A=u.left+(u.width/2);z=u.top+(u.height/2);v=this.toolTip.get("parentNode").get("region");C=this.toolTip.get("region");if(u){switch(y){case"b":q.replaceClass(f,l);break;case"t":q.replaceClass(l,f);break;case"l":q.replaceClass(j,c);break;case"r":q.replaceClass(c,j);break;}switch(B){case"l":p.replaceClass("rightpointer","leftpointer");p.setStyle(c,"");q.setStyle(c,(u.left-v.left)-(this.pointer.getX()-C.left+(this.pointer.get("offsetWidth")/2))+(u.width/2)+g);break;case"c":if(y=="b"||y=="t"){p.setStyle(c,(C.width/2)-(this.pointer.get("offsetHeight")/2)+g);q.setStyle(c,(u.left-(C.width/2)+(u.width/2))-v.left+g);}else{p.setStyle(f,((C.height/2)-(this.pointer.get("offsetHeight")/2))+g);}break;case"r":p.replaceClass("leftpointer","rightpointer");p.setStyle(c,"");q.setStyle(c,((u.right-C.width)-v.left)+g);break;case"t":p.replaceClass("pointerbottom","pointertop");break;case"b":p.replaceClass("pointertop","pointerbottom");break;}switch(y){case"b":q.setStyle(f,(u.top-v.top+u.height+this.pointer.get("offsetHeight"))+g);break;case"t":q.setStyle(f,(u.top-v.top-C.height-this.pointer.get("offsetHeight"))+g);break;case"l":if(r){q.setStyle(f,(r.getY()-v.top)+g);}else{q.setStyle(f,(z-(this.pointer.getY()-C.top)-(this.pointer.get("offsetHeight")/2))-v.top+g);}q.setStyle(c,(u.left-v.left-C.width-this.pointer.get("offsetWidth"))+g);break;case"r":if(r){q.setStyle(f,(r.getY()-v.top)+g);}else{q.setStyle(f,(z-(this.pointer.getY()-C.top)-(this.pointer.get("offsetHeight")/2))-v.top+g);}q.setStyle(c,u.right-v.left+this.pointer.get("offsetWidth")+g);break;}}},show:function(q,o){var p=b.merge(this.options,o);this.toolTip.removeClass(i);if(q){this.positionToolTip(q,p);}this.toolTip.setAttribute("role",p.role);if(p.scrollIntoView){this.content.scrollIntoView();}return this.content;},hide:function(){this.toolTip.addClass(i);},isVisible:function(){return !this.toolTip.hasClass(i);},destroy:function(){if(this.autohideId!==h){d.getService("autohide").unregister(this.autohideId);this.autohideId=h;}this.toolTipBody.get("parentNode").removeChild(this.toolTipBody);this.toolTipBody=this.pointAtMe=this.toolTip=this.content=this.pointer=h;}};n={create:function(o){return new k(o);}};b.namespace(e);b[e][a]={name:"tooltip",getService:function(p,o){if(!d){d=p;}return n;}};if(m){m.registerService(b[e][a]);}},"1.0");/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("metrologger",function(b){var j=b.ModulePlatform,c,k,g="/perf.gif",h,i={},f,d="MPServices",a="MetroLoggerProvider";function e(o,n){var m=new Image(),l="",p=b.merge(o,{rid:c.getProperty("requestId"),bid:c.getProperty("ywa.rapid.bucket.id")||""});m.id=b.guid();i[m.id]=m;m.onload=m.onerror=function(){delete i[this.id];};b.Object.each(p,function(r,q){l+=encodeURIComponent(q)+"="+encodeURIComponent(r)+"&";});m.src=n+"?"+l;return l;}f={logError:function(m,l){e({moduleId:m,msg:l},k);},logPAPerf:function(l){e(l,g);},logAd:function(l){var m=e(l,h);}};b.namespace(d);b[d][a]={name:"metrologger",getService:function(m,l){if(!c){c=m;}if(!k){k=m.getProperty("jsErrorUrl");h=k;}return(!l||m.getModuleApi(l).getProperty("trusted")?f:null);}};if(j){j.registerService(b[d][a]);}});/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("tablite_service",function(d){var m=d.ModulePlatform,f,n,c=".tab",j=".panel",l="selected",e="on",b="fw-b",h="show-panel",o="tabs",k="menu",i,g="MPServices",a="TabliteProvider";i=function(p){this.body=p.body;this.tabWidget=p.tabWidget;this.navMode=p.navMode||o;this.moduleApi=p.moduleApi;this.tabs=this.body.all(c);this.panels=this.body.all(j);this.selectedTabNodes={tabNode:this.body.one("."+l),panelNode:this.body.one("."+h)};this.listeners=[];};i.prototype={body:undefined,tabWidget:undefined,moduleApi:undefined,tabs:[],panels:[],listeners:null,navMode:null,selectedTabNodes:{tabNode:undefined,panelNode:undefined},autoHideService:null,autoHideId:null,stateMgr:null,setup:function(){var q=0,p,r=this;this.tabs.each(function(s){if(q!==0){p.insert(s,"after");}s.addClass("loaded");p=s;q++;},this);if(this.tabWidget){this.tabWidget.addClass("tab-"+this.navMode+"-loaded");}if(this.navMode===k){this.autoHideService=m.getService("autohide");this.autohideId=this.autoHideService.register({targets:[this.tabWidget],triggers:["click"],hide:function(){r.tabWidget.removeClass("tab-menu-open");r.tabWidget.one(".wrapper").removeClass("popover");}});}this.body.on("click",this._handleClickEvent,this);if(this.moduleApi){this.stateMgr=this.moduleApi.getService("statemgr");}return;},teardown:function(){this.body.detach("click",this._handleClickEvent);if(this.autoHideService){this.autoHideService.unregister(this.autohideId);}return;},switchTab:function(r){var q={tabNode:this.tabs.item(r),panelNode:this.panels.item(r)},p;if(q.tabNode&&q.panelNode){this.selectedTabNodes.tabNode.removeClass(l);this.selectedTabNodes.tabNode.removeClass(e);q.tabNode.addClass(l);q.tabNode.addClass(e);if(this.navMode===o){this.selectedTabNodes.tabNode.removeClass(b);q.tabNode.addClass(b);}this.selectedTabNodes.panelNode.removeClass(h);q.panelNode.addClass(h);this.selectedTabNodes=q;p=this.selectedTabNodes.tabNode.getAttribute("data-tabid");this.stateMgr.saveUserSetting("st",p,this.moduleApi);}return;},_handleClickEvent:function(q){var p=q.target.ancestor(".tab",true);if(this.navMode===k){if(p){if(this.tabWidget.hasClass("tab-menu-open")){this.handleTabClick(p);this.toggleDropdown("close");return;}}if(!this.tabWidget.hasClass("tab-menu-open")){this.toggleDropdown("open");}}else{if(p&&!p.hasClass("tab-disabled")){this.handleTabClick(p);}}return;},handleTabClick:function(p){var q=this._getTabPos(p);this.switchTab(q);},toggleDropdown:function(p){if(p==="close"){this.tabWidget.removeClass("tab-menu-open");this.tabWidget.one(".wrapper").removeClass("popover");}else{this.tabWidget.addClass("tab-menu-open");this.tabWidget.one(".wrapper").addClass("popover");}this.toggleInactiveBeacons();},toggleInactiveBeacons:function(){this.tabWidget.all(".tab").each(function(p){if(p.hasAttribute("data-b-inactive")){p.setAttribute("data-b",p.getAttribute("data-b-inactive"));p.removeAttribute("data-b-inactive");}else{if(p.hasAttribute("data-b")){p.setAttribute("data-b-inactive",p.getAttribute("data-b"));p.removeAttribute("data-b");}}});},_getTabPos:function(q){var r=null,p=0;if(q){this.tabs.each(function(s){if(s===q){r=p;}p++;},this);}return r;}};d.namespace(g);d[g][a]={name:"tablite",getService:function(q,p){if(!f){f=q;}n=q.getService("login",p);return i;}};if(m){m.registerService(d[g][a]);}},"1.0");/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("autohide_service",function(h){var f=h.ModulePlatform,b={},e=-1,a,c="MPServices",g="AutoHideProvider";a={register:function(i){b[++e]=i;if(!i.triggers){i.triggers=["click"];}return e;},unregister:function(i){delete b[i];}};function d(i){h.Object.each(b,function(n){if(h.Array.indexOf(n.triggers,i.type)>-1){var o=i.target,k=n.targets,l=true,m=0,j=k.length;if(!o.inDoc(document)){l=false;}else{for(;m<j&&l;m++){if(o.compareTo(k[m])||(k[m]&&k[m].contains(o))){l=false;}}}if(l){n.hide();}}});}h.on("click",d,document);h.on("keydown",d,document);h.on("unload",function(){h.detach("click",d,document);h.detach("keydown",d,document);},window);h.namespace(c);h[c][g]={name:"autohide",getService:function(){return a;}};if(f){f.registerService(h[c][g]);}},"1.0");/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
(function(){var b,a,e,d,c;c={getContainer:function(){return b;},setChild:function(f){if(b.hasChildNodes()){b.replaceChild(f,b.get("firstChild"));}else{b.appendChild(f);}}};YModules.type_badge={services:[{name:"badge",getService:function(f,g){return c;}}],init:function(f){this.moduleapi=f;a=f.getService("moduleplatform");e=this.Y=f.getService("yui");d=this.N=e.Node;this.badgeModule=null;b=this.Y.one("#badge-container");a.subscribe("navigate",this.handleNavigate,this,true);a.subscribe("modulestart",this.handleModuleStart,this,true);},onviewload:function(h){var g,f;if(h=="default"){g=this.moduleapi.getContextData();if(g&&g.mods){f=g.mods[0];a.registerModule(f);this.badgeModule=f.props.id;a.start(this.badgeModule,true,true);}}},handleNavigate:function(f){location.href=f.url;},handleModuleStart:function(i){var h=i.moduleId,f=a.getModuleApi(h),k=f.getProperty("type"),g=f.getContextData("mods"),j=this.Y;if(k!="badge"){if(j.Lang.isArray(g)){j.Array.each(g,function(l){a.registerModule(l);a.start(l.props.id,true,true);});}}}};})();/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("transport_helper_service",function(f){var a="MPServices",e="TransportHelperServiceProvider",c="abort",d={},g=null;function b(h,i){this.arcadeTransport=h.getService("arcade_transport");this.moduleapi=h.getModuleApi(i);this.arcadeLiteEnabled=h.getProperty("arcadeLiteEnabled");}b.prototype={makeRequest:function(h,k){var j=f.clone(h||{},true),i=this.arcadeTransport;if(j.ups||j.udb||this.arcadeLiteEnabled==="0"){i=this.moduleapi;if(!j.ups){j.noups=1;}delete j.ups;delete j.udb;}j.args=f.merge(j.args,{prid:g});return{transport:i,id:i.makeRequest(j,k),abort:function(){return this.transport.abortRequest(this.id);}};},wasAborted:function(h){return(h&&(h.result===c||h.statusText===c));}};f[a][e]={name:"transport_helper",getService:function(h,i){if(!g){g=h.getProperty("requestId");}if(!d.hasOwnProperty(i)){d[i]=new b(h,i);}return d[i];}};if(f.ModulePlatform){f.ModulePlatform.registerService(f[a][e]);}},"1.0");/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
(function(){var ai=null,t=false,M=true,V=ai,b=ai,au=ai,y,ao=ai,aj=1000/60,aU=2*24*60*60*1000,g=20,aF="click",Q="mouseover",U="mouseout",ak="focus",aw="blur",aG="ul",s="li",aQ="> "+aG+":last-of-type",k="hover",a1="newcontent",I="lastnew",aJ="more",ax="fetch_uuids",a0="content_by_uuid",aA="stream:click",R="stream:dynamic",S="stream:filter",C="stream:refresh",j="location:update",O="stream:fallback",L="stream:loadsuccess",d="stream:new_content",W="stream:entities",H="stream:filters",P="stream:restoreRemovedArticle",D="y-tooltip-stream",aX=D+"-1",aV=D+"-2",aT=D+"-3",aS=D+"-4",aR=D+"-5",ad="hidden",X="dn",a2="remove",av="label",aW="value",o="disabled",i="checked",B="offsetHeight",aP="offsetWidth",aL="height",G="data-ka",E="data-kb",an=s+".rmx-ad",am=s+".related-tweet",F=s+".stream-ad,"+an,ab=an+" .adlink",f=an+" .adv",at=an+" .sp",m=ab+","+f+","+at,n="data-uuid",aq=s+".content",aD="highline",u="data-reason",z="data-i",aZ="data-wikiid",c="data-wikiids",aK="next-batch",ag="."+aK,af="endfilters",J="."+af,ay=".historystate",x=">H2,>UL,>.loading,>.type_login,>.strm-error-msg,>.see-more-button",w="li.cavideo h3 a,li.slideshow h3 a",ah="hovertitle",ar="YPROP:LOCAL",ae="YPROP:SAVE",v="YCUSTOM:MYTEAMS",aY="fblogin",h="ylogin",al="streamLoginType",a=0,aN=".action-drawer-button-wrapper",aE="saved",ap="liked",A="disliked",aH="ads_disliked",r="flagged",aB="drawer-open",T="p_30345831",aI="pos-feedback",aa="neg-feedback",q="hilite",l=aq+"."+q,K="request-manager",Z="streamReadList",ac="streamClosedList",aO="streamEntityFeedbackList",p="streamState",aC="streamFlaggedList",e="data-impr-beacon",aM="data-rmx-beacon",az="data-ad-feedback-beacon",N="data-thirdparty-beacons";YModules.type_stream={body:ai,list:ai,lastScrollCheck:0,scrollThrottle:40,scrollBuffer:50,id:"",moduleapi:ai,platform:ai,viewevents:[aF],instrumentation:ai,batchCount:1,pollBatchCount:0,batchSize:0,clientPagination:ai,items:ai,woeId:ai,intl:ai,ccode:ai,filter:ai,itemRemovalTimer:ai,currentRemovalMenu:ai,pendingNewItems:[],swipeMenu:ai,yepService:ai,yepPlayer:ai,evtStreamEntities:ai,isRmp:t,nativeAds:[],locationPickerEnabled:false,locationService:null,locationInstance:null,init:function(a4){V=a4.getService("yui");b=V.config.win;au=V.config.doc;try{ao=!!(b.history&&b.history.replaceState&&b.history.state!==y);}catch(a3){ao=t;}var Y=a4.getContextData();this.moduleapi=a4;this.id=a4.getId();this.platform=a4.getService("moduleplatform");this.transportHelperService=a4.getService("transport_helper");this.listeners=[];this.customEvents=[];this.instrumentation=a4.getService("instrumentation");this.storage=a4.getService("storage");this.statemgr=a4.getService("statemgr");this.saveForLaterService=a4.getService("saveforlater");this.highlineService=a4.getService("stream_highline");this.userinfo=a4.getService("userinfo");this.loginService=a4.getService("login");this.interestsService=a4.getService("interests");this.batchSize=Y.batchSize||20;this.woeId=Y.woeId;this.intl=Y.intl;this.ccode=Y.ccode||"";this.listId=Y.listId||"";this.pageloadListId=Y.pageloadListId||"";this.blogType=Y.blogType||"";this.items=Y.items||[];this.clientPagination=Y.clientPagination;this.filter={category:Y.filter||"",name:Y.catName||""};this.contentpos=Y.contentpos;this.dynamicEnabled=Y.dynamicEnabled;this.removalMenuEnabled=Y.removalMenuEnabled;this.adsRemoveEnable=Y.adsRemoveEnable;this.bucketid=a4.getContextData("bucketid");this.pollForNewBroadcastEnabled=Y.pollForNewBroadcastEnabled;this.pollForNewFrequency=Y.pollForNewFrequency;this.pollForNewAutoInsert=Y.pollForNewAutoInsert;this.pollForNewPauseOnIdle=Y.pollForNewPauseOnIdle;this.userIdleAfter=Y.userIdleAfter;this.newCountInTitleEnabled=Y.newCountInTitleEnabled;this.pendingNewItems=Y.pendingNewItems||[];this.restoreStateExpire=Y.restoreStateExpire;this.restoreStateMethod=Y.restoreStateMethod;this.restoreStateOnCacheMiss=Y.restoreStateOnCacheMiss;this.batchPause=Y.batchPause;this.endFiltersEnabled=Y.endFiltersEnabled;this.endFiltersCount=Y.endFiltersCount;this.activeItemId=Y.contentId;this.highlightActive=Y.highlightActive;this.highlightActiveBroadcastScroll=Y.highlightActiveBroadcastScroll;this.itemClickBroadcastOnly=Y.itemClickBroadcastOnly;this.itemClickContext=Y.itemClickContext;this.markAsReadEnabled=Y.markAsReadEnabled;this.closeEnabled=Y.closeEnabled;this.fbAcctLinked=Y.fbAcctLinked;this.tooltipsEnabled=Y.tooltipsEnabled;this.interestFiltersEnabled=Y.interestFiltersEnabled;this.interestFiltersBroadcast=Y.interestFiltersBroadcast;this.broadcastDynamicEnabled=Y.broadcastDynamicEnabled;this.sortBy=Y.sortBy;this.isRmp=Y.isRmp;this.minArticleCount=Y.minArticleCount;this.saveEnabled=Y.saveEnabled;this.postLoadActionDrawer=Y.postLoadActionDrawer;this.inlineLightboxEnabled=Y.inlineLightboxEnabled;this.actionDrawerEnabled=Y.actionDrawerEnabled;this.actionDrawerButtonsEnabled=Y.actionDrawerButtonsEnabled;this.writeMixerActions=Y.writeMixerActions;this.readMixerActions=Y.readMixerActions;this.inFallbackState=Y.inFallbackState;this.nonPersonalStream=Y.nonPersonalStream;this.registerRapidInViewport=Y.rapidInViewport;this.flagContentEnabled=Y.flagContentEnabled;this.pageload=M;if(Y.splitOnscroll){this.pagescroll=t;}if(this.interestsService&&Y.interestsData){this.interestsService.set(Y.interestsData);}if(!this.filter.category&&this.pageloadListId&&this.listId!==this.pageloadListId){this.filter.category="LISTID:"+this.listId;}V.Node.DOM_EVENTS.mouseenter=1;V.Node.DOM_EVENTS.mouseleave=1;V.Node.DOM_EVENTS.touchend=1;V.Node.DOM_EVENTS.pageshow=1;a4.listen(S);a4.listen(R);a4.listen(C);this.platform.subscribe(j,this.handleLocationUpdate,this);V.on("pageshow",function(a5){this.markRead();},b,this);this.initGlobalListeners();this.videoManager=null;if(a4.getContextData("videoPlayerJs")){this.videoManager=a4.getService("inline_video_manager");}},onviewload:function(a3){if(a3==="default"){var Y=this.moduleapi;this.body=Y.getViewNode(a3);this.rapidContainer=this.body.ancestor(".rapid-container")||this.body;this.isLoading=t;this.locationPickerEnabled=Y.getContextData("locationPickerEnabled");this.setupScroll();if(this.restoreStateExpire){this.restoreState(this.initDefaultView);}else{this.initDefaultView();}}},initDefaultView:function(){if(this.storage){this.storage.onReady(this.setupDefaultView,this);}else{this.setupDefaultView();}},setupDefaultView:function(){var a4=this.moduleapi,a5=a4.getContextData("dynamicCategories"),a3=a4.getContextData("dynamicEntities"),a6=this.activeItemId&&this.getItemByUuid(this.activeItemId);if(this.postLoadActionDrawer){this.addActionDrawer();}this.markRead();this.markFlag();this.updateDislikedInterests();this.updateControls();if(this.readMixerActions){this.getMixerActionsForFirstBatch();}this.cacheNativeAdData();this.initPagination();this.statemgr.removeUserModuleState("context");if(a6){if(this.highlightActive){this.highlightItem(a6);if(!this.restored){if(this.highlightActiveBroadcastScroll){V.Global.fire("media:scroll-into-view",{node:a6});}else{this.scrollDomNode.scrollTop=a6.get("offsetTop")-(this.scrollNodeHeight-a6.get(B))/2;}}}if(this.interestFiltersBroadcast){this.broadcastEntities(a6);}}if(!a4.getContextData("skipCheckBufferOnload")){V.later(0,this,this.checkScroll);}this.platform.on("ready",function(){if(a5&&V.Lang.isArray(a5)&&a5.length>0&&!this.inFallbackState){this.moduleapi.broadcast(R,{dynamicCategories:a5});}if(this.broadcastDynamicEnabled){this.broadcastDynamicFilters({dynamicCategories:a5,dynamicWikis:a3});}if(this.inFallbackState){this.moduleapi.broadcast(O,{});this.dynamicCats=ai;}this.moduleapi.broadcast(S,V.merge(this.filter,{norefresh:1}));},this);if(this.pollForNewFrequency&&this.body.one(aq)){if(!this.pollForNewAutoInsert){this.listeners.push(this.body.delegate(aF,this.onClickNewContentNotice,".newcontentnotice button",this));this.listeners.push(V.on("resize",V.bind(this.positionNewContentNotice,this,M)));}if(this.pollForNewPauseOnIdle&&this.userIdleAfter){this.idleService=a4.getService("idle");if(this.idleService){this.idleService.on("idleChange",this.onIdleChange,this);this.idleService.start(this.userIdleAfter);}}this.scheduleNewContentPoll();if(this.pendingNewItems.length){this.onNewContent();}}if(this.saveForLaterService){this.saveForLaterWidget=new this.saveForLaterService({body:this.body,moduleApi:a4,writeToMixer:this.writeMixerActions,itemSelector:aq,saveHandler:V.bind(this.onSaveArticle,this),signedOutSaveHandler:V.bind(this.onSignedOutSaveClick,this)});}if(this.actionDrawerEnabled){this.actionDrawer=a4.getService("stream_action_drawer");if(this.actionDrawer){this.actionDrawer.on("declareFeedback",this.onActionDrawerFeedback,this);this.actionDrawer.on("removeStreamItem",this.removeStreamItem,this);this.actionDrawer.on("onFlagDone",this.onFlagDone,this);this.actionDrawer.on("recordFlag",this.recordFlag,this);this.actionDrawer.on("deleteSaved",this.deleteSavedFromActionDrawer,this);if(!this.actionDrawerButtonsEnabled){this.actionDrawer.on("drawerToggleStart",this.disableStreamButtons,this);this.actionDrawer.on("drawerToggleComplete",this.enableStreamButtons,this);this.actionDrawer.disableButtons();}}}if(a4.getContextData("swipeEnabled")){this.swipeMenu=a4.getService("stream_swipe_menu");this.swipeMenu.init({rootNode:this.body,swipeEducCount:a4.getContextData("swipeEducCount"),swipeEducMaxViews:a4.getContextData("swipeEducMaxViews"),filter:this.filter,closeEnabled:this.closeEnabled,eventHandlers:{onRemoveTransition:V.bind(this.fancyRemove,this),onRemoveContent:V.bind(this.removeContent,this),onSavedRemove:this.saveForLaterService?V.bind(this.deleteSavedArticle,this):ai}});}if(this.tooltipsEnabled){try{this.tooltip=a4.getService("tooltip").create({parentNode:this.body,className:D,position:{box:"t",arrow:"c"}});this.tooltip.getNode().addClass("fz-xxs");this.listeners.push(this.body.delegate([Q,ak],this.onShowTooltip,".label, .profile-img, .more, .side-button",this));this.listeners.push(this.body.delegate([U,aw],this.onHideTooltip,".label, .profile-img, .more, .side-button",this));}catch(Y){}}if(a4.getContextData("playIconHoverEnabled")){this.listeners.push(this.body.delegate([Q,U],this.onHoverTitle,w,this));}if(this.removalMenuEnabled){this.listeners.push(this.body.delegate(Q,this.onMouseOverMenu,".remove",this));this.listeners.push(this.body.delegate(U,this.onMouseOutMenu,".remove",this));}if(this.adsRemoveEnable){this.listeners.push(this.body.delegate(Q,this.onMouseOverRemoveBtn,".close",this));}if(this.interestFiltersEnabled){this.listeners.push(this.body.delegate([Q,ak],this.onMouseOverLi,".content",this));this.listeners.push(this.body.delegate([U,aw],this.onMouseOutLi,".content",this));}if(V.UA.ie&&V.UA.ie<=6){this.listeners.push(this.body.delegate([Q,U],this.onHoverContent,"ul .content",this));}this.pruneClosed();if(this.filter.category===ar&&this.locationPickerEnabled===true){this.initLocation();}V.Global.fire("pane-manager:sync-nav-pane-scroll");},addActionDrawer:function(){var Y=this.moduleapi.getString("STR.ACTIONDRAWER.MARKUP"),a3=this.body.all(aq);if(!Y||!a3){return;}a3.each(function(a4){if(!a4.hasClass("rmx-ad")){a4.one(".body").insert(Y,"after");}});},onviewunload:function(Y){if(Y==="default"){this.body=ai;if(this.streamLoadReqObj){this.streamLoadReqObj.abort();this.streamLoadReqObj=ai;}V.Array.each(this.listeners,function(a3){a3.detach();});this.listeners=[];V.Array.each(this.customEvents,function(a3){a3.fired=t;});this.customEvents=[];if(this.scrollListener){this.scrollListener.detach();this.scrollListener=ai;}if(this.newContentPoll){this.newContentPoll.cancel();this.newContentPoll=ai;}if(this.tooltip){this.tooltip.destroy();this.tooltip=ai;}if(this.locationPickerEnabled){this.locationService=null;if(this.locationInstance){this.locationInstance.destroy();this.locationInstance=null;}}}},onmessage:function(a5,a3,a4){switch(a5){case S:if(!a4||!a4.norefresh){if(this.videoManager&&this.videoManager.onmessage){this.videoManager.onmessage(a5,a3,a4);}this.onFilter(a4);}break;case C:if(this.videoManager&&this.videoManager.onmessage){this.videoManager.onmessage(a5,a3,a4);}this.onFilter(this.filter);break;case R:this.moduleapi.unlisten(R);this.dynamicCats=a4.dynamicCategories;var Y=this.getNode(J);if(Y){this.handleStreamEnd(Y);}break;default:}},handleLocationUpdate:function(Y){if(this.platform.getProperty("loc.cookie.persistent")&&this.statemgr){this.statemgr.setUserPageState("_fpts",Math.round(new Date().getTime()/1000));}this.woeId=Y.woe;if(this.filter.category===ar){this.onFilter(this.filter);}},onviewevent:function(a3,Y){if(a3==="default"){if(Y.type===aF){this.onClick(Y);}else{}}},initLocation:function(a3){var a5=this.body.one(".loc-picker"),a4=this.moduleapi,Y;if(a5){if(!a5.one(".loc-picker-link")){return false;}if(!this.locationService){this.locationService=a4.getService("location_service");}Y={locDropSettings:{crumb:a4.getContextData("locdrop_crumb"),locale:a4.getContextData("locale"),bestLoc:a4.getContextData("best_loc"),curLoc:a4.getContextData("cur_loc"),defLoc:a4.getContextData("def_loc"),userLoc:this.userCitySelection||a4.getContextData("user_loc"),anchorClass:"",glApi:a4.getContextData("useGlApi")},beacon:{sec:a4.getContextData("beacon_sec"),slk:a4.getContextData("beacon_slk"),test:a4.getContextData("bucketid")}};if(this.locationInstance&&a3){this.locationInstance.destroy();this.locationInstance=null;if(this.locationService){this.locationInstance=this.locationService.create(a5,this.id,a4,Y);}}else{if(!this.locationInstance){if(this.locationService){this.locationInstance=this.locationService.create(a5,this.id,a4,Y);}}}}},loadContent:function(a3,a4,a6){var a5,Y={};if(this.pollRequestObj&&!a3.poll){this.pollRequestObj.abort();this.pollRequestObj=ai;}if(this.filter.category===ar){Y.ups=M;}else{if(this.filter.category===v){Y.udb=M;}}a6=a6||{};a5=this.transportHelperService.makeRequest(V.merge({type:"module",moduleId:this.id,args:V.merge({_action:"show",batch:this.batchCount+1,cat:this.filter.category||"",catName:this.filter.name||"",sb:this.sortBy,ccode:this.ccode,woeid:this.woeId},a3)},Y),{success:a6.success||this.loadContentSuccess,failure:a6.failure||this.loadContentFailure,scope:this,argument:V.merge(a4,{subAction:a3._subAction})});return a5;},loadContentSuccess:function(a8,a6){var a4=this.moduleapi,a3=this.getNode(a6.insertNode),a7=this.getNode(a6.removeNode),a5,Y;if(a8.html){if(a3){a3.insert(a8.html,a6.insertLoc);}this.pruneClosed();this.markRead();this.markFlag();this.instrumentation.refreshModuleAsRichView(this.rapidContainer);}if(a7){a7.remove();}if(a7||a3){this.cacheNativeAdData();}if(a6.subAction===aJ){this.isLoading=t;a5=a4.getContextData("dynamicCategories");if(a5&&V.Lang.isArray(a5)&&a5.length>0&&!this.inFallbackState){if(this.filter&&this.filter.category===""){this.platform.on("ready",function(){a4.broadcast(R,{dynamicCategories:a5});},this);}}Y=a4.getContextData("dynamicEntities");if(a8.hasOwnProperty("data")){if(a8.data.hasOwnProperty("contentpos")){this.contentpos=a8.data.contentpos;}if(a8.data.comscore==="pageview_candidate"){this.instrumentation.fireComscoreBeacon();}if(a8.data.hasOwnProperty("items")&&V.Lang.isArray(a8.data.items)){this.items=this.closeEnabled?this.removeDuplicates(a8.data.items,this.storage.getSet(ac,M)):a8.data.items;}if(this.interestsService&&a8.data.hasOwnProperty("interestsData")){this.interestsService.set(a8.data.interestsData);}}if(a6.firstBatch){if(this.readMixerActions){this.getMixerActionsForFirstBatch();}this.ccode=a4.getContextData("ccode");this.clientPagination=a4.getContextData("clientPagination");}}else{if(a6.subAction===a0){this.contentReqDone=M;}}this.batchCount+=1;this.moduleapi.broadcast(L,{category:this.filter.category,batchCount:this.batchCount});this.body.all("a.twitter-follow-button").each(function(a9){b.twttr.widgets.load(a9.getDOMNode());});if(this.filter.category===ar&&this.locationPickerEnabled===true){this.initLocation(true);}V.later(aj,this,function(){this.body.setStyle(aL,ai);var a9=this.getNode(J);if(a9){this.handleStreamEnd(a9);}else{this.checkScroll();}});V.Global.fire("pane-manager:sync-nav-pane-scroll");},loadContentFailure:function(a4,Y){if(this.transportHelperService.wasAborted(a4)){return;}var a3=this.getNode(Y.removeNode);if(a3){a3.remove();}if(Y.subAction===aJ){this.isLoading=t;if(Y.firstBatch&&this.filter.category){this.moduleapi.broadcast(S,{category:""});}}V.later(aj,this,function(){this.body.setStyle(aL,ai);});},fetchContentIds:function(){var Y,a3;Y={_subAction:ax,listid:this.listId,blogtype:this.blogType,key:this.getContinuationKey()};if(!this.clientPagination||!Y.key){return;}this.isLoading=M;a3={success:function(a7){var a4,a6,a5=this.body.one(aQ);if(a7&&a7.data){a4=a7.data.items;a6=a7.data.dynamicCategories;if(a7.data.fbcount&&a5){a5.append("<!-- fb="+a7.data.fbcount+" uuids -->");}}this.isLoading=t;if(a4&&V.Lang.isArray(a4)){this.items=this.removeDuplicates(a4,this.items,a5?a5.all(aq):[],this.closeEnabled?this.storage.getSet(ac,M):[]);}if(a6&&V.Lang.isArray(a6)){this.moduleapi.broadcast(R,{dynamicCategories:a6});}if(this.items.length===0){this.handleStreamEnd();}else{this.checkScroll();}},failure:function(a4){if(this.transportHelperService.wasAborted(a4)){return;}this.isLoading=t;if(this.items.length===0){this.handleStreamEnd();}}};this.streamLoadReqObj=this.loadContent(Y,{},a3);},loadNextBatch:function(a3,a6,a9){if(this.isLoading){return;}var a7=this.body.one(ag),a5,a8,Y,a4;if(!a7){return;}if(a9){Y=parseInt(this.moduleapi.getContextData("splitSnippetCount"),10);if(this.batchSize<=Y){return;}a4=this.items.splice(0,this.batchSize-Y);}else{a4=this.items.splice(0,this.batchSize);}a5={_subAction:aJ,items:a4,listid:this.listId,blogtype:this.blogType,left:this.items.length,key:this.getContinuationKey(a7),cpos:this.contentpos};if(a6){a5.data=a6;}a8={removeNode:a7,insertNode:a7,insertLoc:"after",firstBatch:a3};if(a9){a5.partialBatch=M;}if(!a3){this.instrumentation.fireBeacon(a7);}if(a7.hasClass("loading")&&(a5.key||a5.items.length)){this.isLoading=M;a7.setContent(this.moduleapi.getString("STR.LOADING"));this.streamLoadReqObj=this.loadContent(a5,a8);}else{if(a7){this.handleStreamEnd(a7);}}},handleStreamEnd:function(a6){a6=a6||this.getNode(ag+","+J);if(!a6){return;}var a3=this.dynamicCats,a5=this.filter.category,Y=[],a4=0;if(this.endFiltersEnabled&&a3&&a3.length){a6.removeClass(aK).replaceClass("loading",af);V.Array.each(a3,function(a7){if(a7.id!==a5&&a4<this.endFiltersCount){Y[a4++]='<a href="#" class="interest-filter rapidnofollow whs-nw" data-action-outcome="slctfltr" data-filter="'+a7.id+'" data-ylk="rspns:nav;t1:a3;t2:strm;t3:ft;sec:strm;ft:2;elm:itm;elmt:fltr;itc:1;cpos:'+a4+';" role="button">'+a7.name+"</a>";}},this);a6.setContent(!Y.length?"":'<h4 class="fz-s">'+this.moduleapi.getString("STR.END_FILTERS_HEADING")+'</h4><p class="fz-s">'+Y.join('<span class="v-h mr-s">, </span>')+"</p>");this.instrumentation.refreshModule(this.rapidContainer);}else{a6.remove();}},setHistoryState:function(a3,Y){if(a3&&Y){a3._expires=+(new Date())+Y;}if(this.restoreStateMethod==="LOCAL_STORAGE"){if(a3){a3.href=b.location.href;this.storage.setItem(p,a3);}else{this.storage.removeItem(p);}}else{if(this.restoreStateMethod==="HTML5_HISTORY"&&ao){b.history.replaceState(a3,"");}else{try{this.getNode(ay).set(aW,V.JSON.stringify(a3));}catch(a4){}}}},getHistoryState:function(){var Y=ai,a4;if(this.restoreStateMethod==="LOCAL_STORAGE"){Y=this.storage.getItem(p);if(Y&&Y.href!==b.location.href){Y=ai;}}else{if(ao){Y=b.history.state;}else{a4=this.getNode(ay);if(a4&&a4.get(aW)){try{Y=V.JSON.parse(a4.get(aW));}catch(a3){}}}}if(Y){this.setHistoryState(ai);}return(Y&&(!Y._expires||new Date()<Y._expires))?Y:ai;},saveState:function(){var a3=[],a4=ai,Y=this.clickedItem||this.clickedLink,a5;if(Y){this.body.all(aq).each(function(a6){var a7=a6.getAttribute(n);if(a6.test(an)){return;}else{if(a6.test(am)){a7="tweet:"+a7;}}a3.push({u:a7,r:a6.getAttribute(u),i:a6.getAttribute(z)});});a5=this.scrollDomNode.scrollTop;a4={time:this.getNode(ay).getAttribute("data-time"),items:a3,listId:this.listId,pending:this.items,filter:this.filter,scrollX:this.scrollDomNode.scrollLeft,scrollY:a5,sortBy:this.sortBy,relY:Y.getY()-a5,itemId:(this.clickedItem)?this.clickedItem.getAttribute(n):ai,activeItemId:this.activeItemId||V.Object.getValue(b,["YUI","type_stream","activeItemId"])};}this.setHistoryState(a4,this.restoreStateExpire);},restoreState:function(a9){var a8,a3,a7=t,ba=this,Y=ba.getHistoryState(),a5=ba.getNode(aQ),a4={},a6={};if(this.filter.category===ar&&this.locationPickerEnabled===true){this.initLocation();}if(a5&&Y&&Y.items&&Y.items.length&&V.Object.getValue(Y,["filter","category"])!==ae){a8=(Y.time===ba.getNode(ay).getAttribute("data-time"));a4._subAction=aJ;a4.restore=1;ba.activeItemId=Y.activeItemId;ba.sortBy=Y.sortBy;ba.updateControls();if(a8||this.restoreStateOnCacheMiss){a3=Y.pending;a4.items=Y.items;a4.listid=Y.listId;a4.left=a3.length;a4.batch=1;a4.cpos=0;a6.insertNode=this.body;a7=M;}else{Y.items=ba.removeDuplicates(Y.items,a5.all(aq));ba.scrollDomNode.scrollLeft=Y.scrollX;ba.scrollDomNode.scrollTop=Y.scrollY;ba.restored=!Y.items.length;a9.call(ba);return;}ba.isLoading=M;ba.filter=Y.filter;ba.loadContent(a4,a6,{success:function(bd,bc){bd.data.items=a3;delete bd.data.comscore;if(a7){ba.body.all(x).remove();}ba.loadContentSuccess(bd,bc);ba.restored=M;a9.call(ba);var bb=Y.itemId&&ba.getItemByUuid(Y.itemId);ba.scrollDomNode.scrollLeft=Y.scrollX;ba.scrollDomNode.scrollTop=bb?bb.getY()-Y.relY:Y.scrollY;V.later(0,ba,function(){ba.checkScroll();if(ba.pollForNewFrequency){ba.checkForNewContent();}});},failure:function(bc,bb){ba.loadContentFailure(bc,bb);a9.call(ba);}});}else{a9.call(ba);}},updateDocTitle:function(Y){if(!this.newCountInTitleEnabled){return;}if(!this.originalDocTitle){this.originalDocTitle=V.Lang.trim(au.title);if(!this.originalDocTitle){return;}}var a3=this.originalDocTitle;if(Y){if(Y>g){a3=V.Lang.sub(this.moduleapi.getString("STR.NEWCONTENT.TITLE.OVERMAX"),{count:g,title:a3});}else{a3=V.Lang.sub(this.moduleapi.getString("STR.NEWCONTENT.TITLE"),{count:Y,title:a3});}}au.title=a3;},onIdleChange:function(Y){if(this.pollForNewPauseOnIdle){this.pollForNewPaused=Y.idle;if(!this.pollForNewPaused&&this.pollForNewSkipped){this.checkForNewContent();}}},scheduleNewContentPoll:function(){if(this.newContentPoll){this.newContentPoll.cancel();}this.newContentPoll=V.later(this.pollForNewFrequency,this,this.checkForNewContent);},checkForNewContent:function(){if(this.pollForNewPaused){this.pollForNewSkipped=M;return;}if(this.isLoading||this.filter.category||this.sortBy!==a){V.log("skipping checkForNewContent: isLoading="+this.isLoading+", sort="+this.sortBy+", filter="+V.Object.getValue(this.filter,["category"]),"debug","type_stream");this.scheduleNewContentPoll();return;}var Y={_subAction:ax,key:0,poll:1},a3={},a4={success:function(a6){this.pollRequestObj=ai;var a5=V.Object.getValue(a6,["data","items"]),a7;if(a5){a7=this.body.all(aq);a5=this.removeDuplicates(a5,a7.size()?a7:[],this.closeEnabled?this.storage.getSet(ac,M):[],this.items);if(a5.length){this.pendingNewItems=a5;this.broadcastNewContentNotice(a5.length);this.onNewContent();}this.scheduleNewContentPoll();}},failure:function(a5){this.pollRequestObj=ai;}};this.pollRequestObj=this.loadContent(Y,a3,a4);this.pollForNewSkipped=t;},onNewContent:function(){this.updateDocTitle(this.pendingNewItems.length);if(this.pollForNewAutoInsert){if(this.body.getY()>this.scrollDomNode.scrollTop){this.instrumentation.fireYwaBeacon({action:"insert",sec:"td-strm-new",slk:"insert"});this.insertNewContent();}}else{this.displayNewContentNotice(this.pendingNewItems.length);}},broadcastNewContentNotice:function(a3){if(!this.pollForNewBroadcastEnabled){return;}var Y="STR.NEWCONTENT.BROADCAST."+(["ZERO","ONE","TWO"][a3]||"OTHER"),a5=Y&&this.moduleapi.getString(Y)||"",a4=a5&&V.Lang.sub(a5,[a3])||"";this.moduleapi.broadcast(d,{count:a3,message:a4});},displayNewContentNotice:function(a4){var a8=this.moduleapi.getString("STR.NEWCONTENT.NOTICE.MESSAGE."+(a4===1?"SINGLE":(a4>g?"OVERMAX":"PLURAL"))),a7=V.Lang.sub(a8,{count:(a4>g?g:a4)}),Y=V.Lang.sub(this.moduleapi.getString("STR.NEWCONTENT.NOTICE.TEMPLATE"),{msg:a7}),a5=this.body.one(aQ),a6=V.Node.create(Y),a3=this.body.one(".newcontentnotice");if(!a5){return;}if(a3){a3.replace(a6);}else{a5.insert(a6,"before");this.instrumentation.fireYwaBeacon({action:"secview",sec:"td-strm-msg",outcome:"msgview"});}this.newContentNotice=a6;this.positionNewContentNotice();this.highlightNewItems(ai);},onClickNewContentNotice:function(Y){this.newContentNotice.remove();this.newContentNotice=ai;this.scrollToTop();this.instrumentation.fireBeacon({sec:"td-strm-msg",slk:"top",itc:1});this.insertNewContent();},getMixerActionsForFirstBatch:function(){if(this.filter.category===ae||this.filter.category===ar){return;}var Y=this.getUuids();if(Y.length){this.makeRequestToGetMixerActions(Y,{success:function(a3){this.markStreamActions(a3.data.mixerActions);},failure:function(a3){},scope:this});}},onActionDrawerFeedback:function(Y){this.onDeclareInterest(Y.interestObj,Y.item);},beaconDislikeAds:function(a6,a5,a8,a7){var a4,a9,Y,a3;a9=a6.getAttribute(az);a3="({type}{subo}{cmnt})";if(a3){a4={rmx:a9,type:a5&&a5!==""?"type$"+a5:"",subo:a8&&a8!==""?",subo$"+a8:"",cmnt:a5==="fdb_submit"?",cmnt$"+a7:""};Y=a9.replace("$(AD_FEEDBACK)",V.Lang.sub(a3,a4));this.instrumentation.getBeaconImage(Y);}},removeStreamItem:function(a9){var ba=a9.item,a5="",a6="",a8=!a9.animate?a9.uuid:ba?ba.getAttribute(n):ai,a4=a9.action||ai,a3,Y=ba.next(".ads_disliked")||ai,a7=a4===aH?this.moduleapi.getString("STR.REMOVE.ADS.THANKYOU"):this.moduleapi.getString("STR.REMOVE.ITEM.THANKYOU");if(a4===aH){if(Y){if(Y.one("[name=ads-dislike-option]:checked")){a5=Y.one("[name=ads-dislike-option]:checked").get("value")||"";a6=Y.one("#cmnt").get("value")||"";this.beaconDislikeAds(ba,"fdb_submit",a5,a6);}}}if(a8){if(this.filter.category!==ae){if(a9.immediate){ba.remove();}else{if(a9.animate){if(this.actionDrawerEnabled){ba.one(".wrapper").addClass("dn");ba.append(a7);if(a4===aH){ba.setStyle("background-color","");}if(ba.hasClass("featured")){ba.replaceClass("featured","featured-removed");}if(ba.one(".fb-friends")){ba.one(".fb-friends").addClass("dn");}a3=ba.one(".action-drawer-button-wrapper");if(a3){a3.addClass("dn");}}else{ba.setContent(a7);}ba.addClass("remove-item");this.removalTimer=V.later(3000,this,function(){this.fancyRemove(ba);});}}this.recordClosed(a8);}}},onFlagDone:function(a6){var a3=a6.item,a7=!a6.animate?a6.uuid:a3?a3.getAttribute(n):ai,a5=this.moduleapi.getString("STR.FLAG.ITEM.THANKYOU"),a4,Y;if(a7){if(a6.animate){a4='<li class="flag-thankyou-msg-drawer">'+a5+"</li>";a3.insert(a4,"after");Y=a3.get("nextSibling");V.later(3000,this,function(){this.fancyRemove(Y);});}}},recordFlag:function(a3){var Y=a3.item,a4=Y?Y.getAttribute(n):ai;if(a4){if(a3.flag){this.storage.addToSet(aC,a4,1,aU);}else{this.storage.removeFromSet(aC,a4);}}},deleteSavedFromActionDrawer:function(Y){this.deleteSavedArticle();},restoreRemovedArticle:function(a4){var a5=a4.one(".action-drawer-button-wrapper"),a6=a4.one("h3 a").get("text").substring(0,8),a3=a4.getAttribute(n),Y=V.merge(this.instrumentation.getBeaconKeys(a4),{sec:"td-strm-rm",slk:"undo-itm",ltxt:a6,itc:1,action:aF,outcome:"undo"});if(this.removalTimer){this.removalTimer.cancel();a4.one(".remove-wrap").remove();a4.setStyle("background-color","#FAFAFF");a4.one(".wrapper").removeClass("dn");if(a4.hasClass("remove-item")){this.beaconDislikeAds(a4,"fdb_undo","","");}a4.removeClass("remove-item").removeClass(aH);a4.removeClass("remove-item").removeClass(A);a4.removeClass("y-pattern").removeClass("hover");this.enableStreamButtons({item:a4});if(a4.one(".fb-friends")){a4.one(".fb-friends").removeClass("dn");}if(a5){a5.removeClass("dn");}if(a4.hasClass("featured-removed")){a4.replaceClass("featured-removed","featured");}if(this.actionDrawer&&a3){if(this.userinfo.isLoggedIn()){this.actionDrawer.markItemFeedbackInMixer(a3,"neutral","dislike");}this.recordClosed(a3,M);}this.instrumentation.fireBeacon(Y);if(this.videoManager&&this.videoManager.onmessage){this.videoManager.onmessage(P,this,{item:a4});}}},insertNewContent:function(){var a3=this.body.one(aQ),a6=350,Y=V.Node.create('<li style="height:0">'+this.moduleapi.getString("STR.LOADING")+"</li>"),a5=+(new Date()),a4=function(a7,a8){this.newContentRequestObj=ai;V.later(Math.max(a6,+(new Date())-a5),this,function(){Y.remove();this.updateDocTitle(0);if(!a7&&a8&&a8.html){var a9=V.Node.create("<ul>"+a8.html+"</ul>").all(aq);if(a3&&a9.size()){a3.prepend(a9);this.highlightNewItems(a9);if(this.interestsService&&a8.data&&a8.data.interestsData){this.interestsService.set(a8.data.interestsData);}}this.instrumentation.refreshModule(this.rapidContainer);this.cacheNativeAdData();this.pollBatchCount+=1;}});};if(!a3){return;}a3.prepend(Y);Y.transition({height:"85px",duration:a6/1000});this.newContentRequestObj=this.loadContent({_subAction:a0,items:this.pendingNewItems,poll:1,ccode:this.ccode,woeid:this.woeId,batch:this.pollBatchCount+1},{},{success:function(a7){a4.call(this,ai,a7);},failure:function(a7){a4.call(this,a7);}});this.pendingNewItems=[];this.broadcastNewContentNotice(0);},getMastheadHeight:function(){var Y=V.one("#masthead");return Y?Y.get(B)-4:0;},scrollToTop:function(){var Y=V.one("#stream")||this.body,a3=Y.getY()-this.getMastheadHeight();if(this.scrollDomNode.scrollTop>a3){this.scrollDomNode.scrollTop=a3;}},positionNewContentNotice:function(a7){if(!this.newContentNotice){return;}var a6=this.newContentNotice,a5=V.one("#stream").one(".filter-bar-section"),Y=this.getMastheadHeight(),a8=a6.hasClass("sticky"),a4,a3=V.one("BODY");if(a5){Y+=a5.get(B);}a4=(this.scrollDomNode.scrollTop>(this.body.getY()-Y));if(a4&&(!a8||a7)&&a3.hasClass("fixed-enabled")){a6.setStyles({top:Y+"px",left:this.body.getX()+"px",width:(this.body.get(aP)-parseInt(a6.getComputedStyle("paddingLeft"),10)-parseInt(a6.getComputedStyle("paddingRight"),10))+"px"}).addClass("sticky");}else{if(a8&&(!a4||!a3.hasClass("fixed-enabled"))){a6.removeClass("sticky").setStyles({top:ai,left:ai,width:ai});}}},highlightNewItems:function(Y){this.body.all("."+a1).removeClass(a1).removeClass(I);if(Y&&Y.size()){Y.addClass(a1);Y.item(Y.size()-1).addClass(I);}},recordRead:function(Y){if(!this.markAsReadEnabled){return;}Y=V.one(Y);if(Y&&Y.hasAttribute(n)&&!Y.test(F)&&!Y.hasClass(aD)){this.storage.addToSet(Z,Y.getAttribute(n),1,aU);Y.addClass("read");}},markRead:function(a3){if(!this.markAsReadEnabled){return;}var Y=this.storage.getSet(Z);if(Y&&V.Object.size(Y)){a3=a3||this.body.all(aq);a3.each(function(a4){var a5=a4.getAttribute(n);if(a5&&Y[a5]){a4.addClass("read");}});}},markFlag:function(a3){if(!this.flagContentEnabled){return;}if(this.filter.category===ae||this.filter.category===ar){return;}var Y=this.storage.getSet(aC);if(Y&&V.Object.size(Y)){a3=a3||this.body.all(aq);a3.each(function(a4){var a5=a4.getAttribute(n);if(a5&&Y[a5]){a4.addClass("flagged");}});}},markStreamActions:function(a6){if(!a6){return;}var a3=(a6.saveforlater&&V.Lang.isArray(a6.saveforlater))?a6.saveforlater:[],Y=(a6.like&&V.Lang.isArray(a6.like))?a6.like:[],a5=(a6.dislike&&V.Lang.isArray(a6.dislike))?a6.dislike:[],a4;V.Array.each(a3,function(a7){a4=this.getItemByUuid(a7);if(a4){a4.addClass(aE);}},this);V.Array.each(Y,function(a7){a4=this.getItemByUuid(a7);if(a4){a4.addClass(ap);}},this);V.Array.each(a5,function(a7){a4=this.getItemByUuid(a7);if(a4){a4.remove();}},this);},recordClosed:function(a3,Y){if(!this.closeEnabled||(this.readMixerActions&&this.userinfo.isLoggedIn())){return;}if(Y){this.storage.removeFromSet(ac,a3);}else{this.storage.addToSet(ac,a3,1,aU);}},pruneClosed:function(a3){if(!this.closeEnabled||this.filter.category===ae){return;}var Y=this.storage.getSet(ac);if(Y&&V.Object.size(Y)&&(this.filter.category!==ar)){a3=a3||this.body.all(aq);a3.each(function(a4){var a5=a4.getAttribute(n);if(a5&&V.Object.owns(Y,a5)){a4.remove();}});}},onDeclareInterest:function(a6,a3){var a4=this.instrumentation.getBeaconKeys(a3),Y={"1":"pos","0":"neu","-1":"neg"},a5=this.userinfo.isLoggedIn();if(a5){a4.dcl=Y[a6.current]+"-"+Y[a6["new"]];}a4.itc=1;a4.action=aF;switch(a6.type){case"entity":a4.sec="td-strm-dr";a4.ltxt=a6.id;a4.slk=a6.source?"prvdr":"ent";if(a5){a4.outcm="dclent";}break;case"content":a4.sec="td-strm-ctrl";a4.ltxt=a3.one("h3 a").get("text").substring(0,8);if(a6.action==="disliked"){a4.rspns=(a6["new"]==="-1")?"rmct":"unrmct";}a4.slk=(a6.action==="liked")?"like":"rm";if(a5){a4.outcm="dclitm";}break;}this.instrumentation.fireBeacon(a4);},initPagination:function(){this.listeners.push(V.after("touchend",this.afterScroll,b,this));this.listeners.push(V.on("resize",function(){this.scrollNodeHeight=this.getScrollNodeHeight();},b,this));if(this.clientPagination){if(this.items.length===0){if(this.pollForNewFrequency||this.dynamicEnabled||this.isInScrollBuffer()){this.fetchContentIds();}else{this.listeners.push(V.onceAfter("scroll",this.fetchContentIds,b,this));}}else{if(this.closeEnabled){this.items=this.removeDuplicates(this.items,this.storage.getSet(ac,M));}}}else{if(this.getContinuationKey()===""){this.batchCount=0;this.loadNextBatch();}}this.scrollBuffer=this.moduleapi.getContextData("scrollBuffer")||this.scrollBuffer;},getContinuationKey:function(a3){var Y=a3||this.body.one(ag);if(Y){return Y.hasAttribute("data-key")?Y.getAttribute("data-key"):ai;}return ai;},getNode:function(Y){return V.Lang.isString(Y)?this.body.one(Y):(Y&&this.body.contains(Y)?V.one(Y):ai);},getItemByUuid:function(a3,Y){Y=Y||this.body;return a3?Y.one(aq+"["+n+'="'+a3+'"]'):ai;},getUuids:function(a3){var Y=a3||this.body.all(aq),a4=[];Y.each(function(a6){var a5=a6.hasAttribute(n)&&a6.getAttribute(n);if(a5){a4.push(a5);}});return a4;},fancyRemove:function(a3){var Y=this;a3=a3&&V.one(a3);if(!a3||!a3.inDoc()){return;}a3.transition({height:0,opacity:0,duration:0.4,easing:"ease-in"},function(){a3.remove();a3=ai;Y.repaint();});},repaint:function(){if(V.UA.ie&&V.UA.ie<8){this.body._node.className=this.body._node.className;}},setupScroll:function(){var Y=au.body||V.Node.getDOMNode(V.one("body"));this.scrollDomNode=this.isRmp?V.Node.getDOMNode(this.body.ancestor(function(a4){var a3=a4.getStyle("overflowY");return(a3==="scroll"||a3==="auto"||a4.compareTo(Y));})):Y;this._scrollNodeIsBody=(this.scrollDomNode===Y);if(this._scrollNodeIsBody&&!V.UA.webkit){this.scrollDomNode=au.documentElement;}this.scrollNodeHeight=this.getScrollNodeHeight();if(this.scrollListener){this.scrollListener.detach();}this.scrollListener=V.one(this._scrollNodeIsBody?b:this.scrollDomNode).after("scroll",this.afterScroll,this);},getScrollNodeHeight:function(){var a3=this.scrollDomNode,Y=this._scrollNodeIsBody;if(Y&&V.UA.webkit){a3=au.documentElement;}return(Y&&V.UA.ios)?b.innerHeight:a3.clientHeight;},isInScrollBuffer:function(){var a3=this.body.get("region"),Y=this.body.get("viewportRegion");if(this.registerRapidInViewport&&a3.height>0&&a3.top<=Y.bottom){this.registerWithRapid();this.registerRapidInViewport=t;}return(a3.height>0&&a3.bottom<(Y.bottom+this.scrollBuffer));},hasScrolled:function(){var a3=this.body.get("region"),Y=this.body.get("viewportRegion");return(a3.height>0&&Y.top>5);},checkScroll:function(){if(this.newContentNotice){this.positionNewContentNotice();}if(this.moduleapi.getContextData("splitFirstBatch")){if(this.moduleapi.getContextData("splitOnload")&&this.pageload){this.batchCount=0;this.loadNextBatch(M,null,M);}else{if(this.moduleapi.getContextData("splitOnscroll")&&!this.pagescroll&&this.hasScrolled()){this.pagescroll=M;this.batchCount=0;this.loadNextBatch(M,null,M);}}}if(this.isInScrollBuffer()){if(!this.batchPause||this.batchCount%this.batchPause){this.loadNextBatch();}}if(this.pollForNewAutoInsert&&this.pendingNewItems.length){this.onNewContent();}this.beaconVisibleNativeAds();if(this.pageload){this.pageload=false;}},onClick:function(a9){var a4=V.one(a9.target),a6="#"+V.DOM.generateID(this.body),ba=a4.ancestor(aq,M,a6),a5=ba&&"#"+V.DOM.generateID(ba),bb=a4.ancestor("a",M,a6),a7,Y="",a3="",a8={};if(bb&&bb.hasClass("fp-article")){a7=a4.ancestor(".fp-open-inline",true);if(a7&&ba.hasClass("fp-bday")){a9.preventDefault();a8={name:ba.getData("bday-name"),bday:ba.getData("bday-date"),hash:ba.getData("bday-hash"),id:ba.getData("bday-fbid")};this.moduleapi.broadcast("fp:open-inline",{sec:"td-strm",ct:"birthday",mode:"embed",module:"birthday",subModuleView:"birthday-story",subModuleData:V.JSON.stringify(a8)});}else{if(this.inlineLightboxEnabled&&a7){if(a7.getAttribute("data-uuid")){Y=a7.getAttribute("data-uuid");}if(a7.getAttribute("href")){a3=a7.getAttribute("href");}else{a3=a7.one("A.rapidnofollow").getAttribute("href");}a9.preventDefault();this.moduleapi.broadcast("fp:open-inline",{uuid:Y,href:a3,sec:"td-strm",ct:"1"});return;}}}if(a4.hasClass("fblink")){return;}if(a4.ancestor(".social-actions",M,a6)&&this.swipeMenu){this.swipeMenu.onClick(a9);return;}if(a4.test(ag+" button")){this.loadNextBatch();return;}if(a4.test('input[name="sb"]')){this.setSortMode(parseInt(a4.get(aW),10),M);return;}if(a4.ancestor(".see-more-button",M,".type_stream")){this.toggleCollapsibleStream(a4.ancestor(".see-more-button",M));return;}if(bb&&bb.test(m)){this.onAdInfoClick(bb,ba);}if(a4.hasClass("interest-filter")){a9.halt();this.moduleapi.broadcast(S,{category:a4.getAttribute("data-filter"),name:a4.getAttribute("data-filter-name")||a4.getContent()});this.filterBeacon(a4);return;}if(ba){if(ba.hasClass("remove")&&a4.ancestor(".menu",M,a5)){this.onRemovalMenuClick(a9);}else{if(this.actionDrawer&&a4.ancestor(aN,M,a5)){this.actionDrawer.toggleDrawer(ba,t);}else{if(this.actionDrawer&&a4.ancestor(".close,.check-icon,.save-button,.flag-content-btn",M,a5)){if(!a4.ancestor("button:disabled",M,a5)){this.handleActionDrawerTrigger(ba,a4);}}else{if(this.actionDrawer&&a4.ancestor(".undo-btn",M,a5)){this.restoreRemovedArticle(ba);}else{if(a4.ancestor(".close",M,a5)){a9.preventDefault();if(ba.hasAttribute(n)){if(this.saveForLaterWidget&&this.filter.category===ae){this.deleteSavedArticle(a4);}else{this.removeContent(ba);}}else{this.fancyRemove(ba);}}else{if(a4.hasClass("share-drawer-icon")){a9.preventDefault();}else{if(a4.ancestor(".share-drawer, .friends-string, .label, .sponsorship",M,a5)){}else{if(ba.hasClass("video-inline")&&this.handleInlineVideo(ba,a4)){a9.preventDefault();}else{if(bb){if(!a4.hasClass("interest-filter")){this.recordRead(ba);}if(a9.which!==2&&a9.button!==4&&!a9.altKey&&!a9.ctrlKey&&!a9.shiftKey&&!a9.metaKey&&bb.getAttribute("target").toLowerCase()!=="_blank"){this.clickedItem=ba;this.clickedLink=ai;if(this.restoreStateExpire&&!ba.hasClass("rss-fallback")){this.saveState();}if(this.itemClickContext){this.statemgr.setUserModuleState("context",{cat:this.filter.category,catName:this.filter.name||"",listid:this.listId||"",blogtype:this.blogType||"",u:ba.getAttribute(n)});}if(this.highlightActive){this.highlightItem(ba);}}}}}}}}}}}}this.moduleapi.broadcast(aA);},handleActionDrawerTrigger:function(bd,a4){var a6=bd&&"#"+V.DOM.generateID(bd),a5=a4.ancestor(".rmx-ad",M,a6)?aH:a4.ancestor(".close",M,a6)?A:a4.ancestor(".check-icon",M,a6)?ap:a4.ancestor(".flag-content-btn",M,a6)?r:aE,Y,bb=this.userinfo.isLoggedIn(),ba,bc,a3=(bd.hasClass(aB)&&bd.get("nextSibling")&&bd.get("nextSibling").hasClass("action-drawer"))?bd.get("nextSibling"):ai,a9,a8,a7;if(bd.get("nextSibling")&&bd.get("nextSibling").hasClass("flag-thankyou-msg-drawer")){bd.get("nextSibling").remove();bd.removeClass("y-pattern").removeClass("hover");}if(a5===aH){if(a3){this.beaconDislikeAds(bd,"fdb_undo","","");}else{this.beaconDislikeAds(bd,"fdb_start","","");}}this.onHideTooltip();if(a5===ap){a9=A;a8=r;a7=aE;}else{if(a5===A){if(this.filter.category===ae){this.actionDrawer.toggleDrawer(bd,M);this.actionDrawer.handleSaveClick();return;}a9=ap;a8=r;a7=aE;}else{if(a5===aE){a9=ap;a8=A;a7=r;}else{if(a5===r){a9=ap;a8=A;a7=aE;}}}}bd.toggleClass(a5);if(a5===aE){ba=bb;bc=bb?t:!bd.test("."+ap+",."+A+",."+r+",."+aH);}else{ba=!bd.hasClass(aB)&&!bd.hasClass(a5);bc=bb?(!a3||!a3.test("."+a9+",."+a8)):(!bd.test("."+a9+",."+a8+",."+a7));}if(!bd.hasClass(aB)||bc){this.actionDrawer.toggleDrawer(bd,ba,a5);}if(a5===aH){if(this.actionDrawer.currentDrawer){this.actionDrawer.showAdsDislikeBtns();}}else{if(bb||(this.nonPersonalStream&&(a5===A))){if(a5===ap){this.actionDrawer.handleLikeClick();}else{if(a5===A){this.actionDrawer.handleDislikeClick();Y=bd.getAttribute(n);this.recordClosed(Y,!bd.hasClass(A));}else{if(a5===aE){this.actionDrawer.handleSaveClick();}else{if(a5===r){this.actionDrawer.handleFlagClick();}}}}this.instrumentation.refreshModule(this.rapidContainer);}else{bd.removeClass(a9).removeClass(a8).removeClass(a7);if(this.actionDrawer.currentDrawer){this.actionDrawer.showLoginBtns();}else{if(a5===ap||a5===A){this.actionDrawer.fireItemInterestChange("0",a5===ap?"1":"-1",a5);}}}}bd.one("h3 a").focus();},disableStreamButtons:function(a3){var Y=a3?a3.item:ai;if(Y){Y.all(".side-button").set(o,M);}},enableStreamButtons:function(a3){var Y=a3?a3.item:ai;if(Y){Y.all(".side-button").set(o,t);}},handleInlineVideo:function(a4,Y){var a5,a3,a6,a7=ai;if(!this.yepService){this.yepService=this.moduleapi.getService("videoyep");if(this.yepService){this.yepPlayer=this.yepService.create();}}if(!this.yepPlayer){return t;}a5=a4.getData();if(!a5.uuid){return t;}if(a5["poster-img"]){a7=a5["poster-img"];}a3=this.instrumentation.getBeaconKeys(a4);a6={analytics:{sec:a3.sec,ccode:this.ccode,cpos:a3.cpos,ct:a3.ct||3},config:{animated:M,attach:a4,location:"prepend",returnTabIndexTo:Y,yep:{autoplay:M,id:a5.uuid},videoPageUrl:a5.url||ai}};if(a7){a6.config.image=a7;}this.yepPlayer.init(a6);this.recordRead(a4);return M;},onRemovalMenuClick:function(be){var a5=be.target,bc,bg=a5.ancestor(aq,M,"#"+V.DOM.generateID(this.body)),a7=V.merge(this.instrumentation.getBeaconKeys(bg),{itc:1,pos:0}),a8,ba,a4,a6,bb,a9,Y,bd={},a3=[],bf=this;if(a5.ancestor("button.undo",M)){this.clearRemovalTimer();Y=bg.getAttribute(n);this.recordClosed(Y,M);bg.one(".menu").remove();bg.removeClass(a2);this.currentRemovalMenu=ai;a8=bg.one(".wrapper .body h3 a").get("text");a8=(a8&&a8.length>8)?a8.substring(0,8):a8;this.instrumentation.fireBeacon(V.mix({action:aF,outcome:"undo",sec:"td-strm-rm",slk:"undo",ltxt:a8},a7));this.repaint();if(this.userinfo.isLoggedIn()&&this.writeMixerActions){a9={_subAction:"article_feedback",uuid:Y,state:"neutral",mixerAction:"dislike"};this.makeInterestRequest(a9);}bg.one(".wrapper .body a").focus();}else{if(a5.ancestor(".wikiid",M,".menu")){bc=a5.ancestor(".wikiid",M,".menu");bb=bc.hasClass(aI)?1:bc.hasClass(aa)?-1:0;if(a5.hasClass("remove-title")){if(bc.hasClass(aI)){bc.replaceClass(aI,aa);}else{if(bc.hasClass(aa)){bc.removeClass(aI).removeClass(aa);}else{bc.replaceClass(aa,aI);}}}else{if(a5.ancestor(".remove-pos",M,".wikiid")){bc.toggleClass(aI).removeClass(aa);}else{if(a5.ancestor(".remove-neg",M,".wikiid")){bc.toggleClass(aa).removeClass(aI);}else{bc.toggleClass(aa);bc.removeClass(aI);}}}a4=bc.hasClass(aI)?1:bc.hasClass(aa)?-1:0;a8=bc.getAttribute(aZ);a6=((bb===1)?"pos":(bb===-1)?"neg":"neu")+"-"+((a4===1)?"pos":(a4===-1)?"neg":"neu");bd[a8]={"new":a4,current:bb,type:bc.getAttribute("data-interesttype")};a3=bd;this.handleRemovalMenuFeedback(a3,function(bi,bj){var bh;if(bf.currentRemovalMenu&&bf.currentRemovalMenu===bg){if(bi===t){if(bf.interestsService){bf.interestsService.update(a8,{state:a4});}bh=a5.ancestor(".remove-menu-main",M,"div");if(!bh.getData("confirmed")){bh.append(bf.moduleapi.getString("STR.BUTTON.REMOVE_DONE"));bh.setData("confirmed",M);bf.repaint();}}else{if(bb===1){bc.replaceClass(aa,aI);}else{if(bb===-1){bc.replaceClass(aI,aa);}else{bc.removeClass(aa).removeClass(aI);}}}}});ba=bg.one(".login");if(ba){ba.removeClass(ad);this.repaint();}if(this.userinfo.isLoggedIn()){this.instrumentation.fireBeacon(V.mix({sec:"td-strm-rm",slk:a6,ltxt:a8,action:aF,outcome:"entitydecl"},a7));}}else{if(a5.ancestor("button.remove-done",M)){bg.one(".menu").empty().setStyle("minHeight",0).append(bf.moduleapi.getString("STR.REMOVE.CONFIRM"));bg.addClass("remove-disappear");bg.removeClass("featured");this.setRemovalTimer();this.repaint();this.instrumentation.fireBeacon(V.mix({slk:"done",ltxt:"done"},a7));}}}},afterScroll:function(Y){if(this.scrollTimer){this.scrollTimer.cancel();}var a3=+(new Date()),a4=a3-this.lastScrollCheck;if(a4>this.scrollThrottle){this.checkScroll();this.lastScrollCheck=a3;}else{this.scrollTimer=V.later(this.scrollThrottle-a4,this,this.checkScroll);}},onHoverContent:function(Y){var a4=Y.currentTarget,a3=Y.relatedTarget;if(a4!==a3&&!a4.contains(a3)){a4.toggleClass(k,(Y.type===Q));}},onHoverTitle:function(Y){var a3=Y.target.ancestor(aq);if(a3){a3.toggleClass(ah,Y.type===Q);}},onMouseOverMenu:function(Y){this.clearRemovalTimer();},onMouseOutMenu:function(Y){this.setRemovalTimer();},onMouseOverLi:function(Y){var a3=Y.currentTarget,a4=Y.target.ancestor(an);this.trimEntityList(a3);if(a4){this.beaconDislikeAds(a4,"fdb_movr_ad","","");}},onMouseOverRemoveBtn:function(Y){var a3=Y.target.ancestor(an);if(a3){this.beaconDislikeAds(a3,"fdb_movr_x","","");}},trimEntityList:function(a3){var Y=a3.one(".interest-list"),a4=Y?a3.one(".attribution").get("region"):ai,a5;if(Y&&!a3.hasClass("remove")){Y.removeClass("dn");Y.removeClass("voh");a5=Y.all(".interest-wrap");while(a5.size()&&!Y.inRegion(a4,M)){a5.pop().remove();}}},onMouseOutLi:function(Y){var a3=Y.currentTarget;this.hideEntityList(a3);},hideEntityList:function(a3){var Y=a3.one(".interest-list");if(Y){Y.addClass("voh");}},onShowTooltip:function(Y){this.showTooltip(Y.currentTarget);},showTooltip:function(a5){var a4=this.tooltip.getNode(),a3=this.moduleapi,Y=a5.ancestor(aq),a7,a6;if(a5.hasClass("side-button")&&this.actionDrawerEnabled){a4.addClass("whs-nw");if(a5.hasClass("save-button")){a6=Y.hasClass("saved")?a3.getString("STR.TOOLTIP.UNDO"):a3.getString("STR.SAVE.SAVETEXT");a4.addClass(aX);}else{if(a5.hasClass("check-icon")){a6=Y.hasClass("liked")?a3.getString("STR.TOOLTIP.UNDO"):a3.getString("STR.INTERESTS.LIKETEXT");a4.addClass(aV);}else{if((this.filter.category===ae)||this.nonPersonalStream){a6=a3.getString("STR.INTERESTS.REMOVETEXT");a7=this.nonPersonalStream?aT:aS;a4.addClass(a7);}else{if(a5.hasClass("close")){a6=Y.hasClass("disliked")||Y.hasClass(aH)?a3.getString("STR.TOOLTIP.UNDO"):Y.hasClass("rmx-ad")?a3.getString("STR.INTERESTS.ADSDISLIKETEXT"):a3.getString("STR.INTERESTS.DISLIKETEXT");a4.addClass(aT);}else{if(a5.hasClass("flag-content-btn")){a6=Y.hasClass("flagged")?a3.getString("STR.TOOLTIP.UNDO"):a3.getString("STR.INTERESTS.FLAGTEXT");a4.addClass(aR);}}}}}}else{if(a5.hasClass("profile-img")){a6=a5.one("img").get("alt");}else{if(a5.hasClass("more")){a6=a5.getAttribute("data-friendlist").split(",").join("<br/>");}}}if(a6){this.tooltip.show(a5,{msg:a6});}},onHideTooltip:function(Y){this.tooltip.hide();this.tooltip.getNode().removeClass(aX).removeClass(aV).removeClass(aT).removeClass(aS).removeClass(aR).removeClass("whs-nw");},onFilter:function(Y){if(this.streamLoadReqObj){this.streamLoadReqObj.abort();this.streamLoadReqObj=ai;}if(this.newContentRequestObj){this.newContentRequestObj.abort();this.newContentRequestObj=ai;}this.filter=Y||{};this.listId=(Y.category&&Y.category.indexOf("LISTID:")===0)?Y.category.slice(7):"";this.batchCount=0;this.contentpos=0;this.isLoading=t;this.items=[];this.pendingNewItems=[];this.broadcastNewContentNotice(0);this.body.setStyle(aL,Math.max(parseInt(this.body.get(B),10),60)+"px");this.body.all(x).remove();this.body.append(this.moduleapi.getString("STR.LOADING.CONTENT"));V.later(aj,this,this.scrollToTop);this.clearRemovalTimer();this.currentRemovalMenu=ai;this.updateDocTitle(0);this.updateControls();this.clearNativeAdData();this.loadNextBatch(M);if(this.saveForLaterWidget&&(Y.category===ae)){this.saveForLaterWidget.onSavedFilter();}if(this.actionDrawer){this.actionDrawer.onFilter(Y);}if(this.swipeMenu){this.swipeMenu.onFilter(Y);}},removeDuplicates:function(Y){var a4={},a3=[];if(Y&&Y.length){if(arguments.length>1){V.each(V.Array(arguments).slice(1),function(a5){V.each(a5,function(a6){if(!a6){return;}if(a6 instanceof V.Node){a4[a6.getAttribute(n)]=1;if(a6.hasAttribute(G)){a4[a6.getAttribute(G)]=1;}if(a6.hasAttribute(E)){a4[a6.getAttribute(E)]=1;}}else{if(V.Lang.isObject(a6)){a4[a6.u]=1;if(a6.ka){a4[a6.ka]=1;}if(a6.kb){a4[a6.kb]=1;}}else{a4[a6]=1;}}});});V.each(Y,function(a5){if((!a4.hasOwnProperty(a5.u))&&(!a5.ka||!a4.hasOwnProperty(a5.ka))&&(!a5.kb||!a4.hasOwnProperty(a5.kb))){a3.push(a5);}});}else{a3=Y.slice(0);}}return a3;},showRemovalMenu:function(a5){var a9=a5.one(".wrapper"),a4=this.parseInterests(a5),Y=a9.get(B),a7,a3,a8,a6;a5.addClass(a2);a3=this.moduleapi.getString("STR.REMOVE.MENU");a7=a5.appendChild(a3);a8=a7.one(".remove-menu-main");a6=a7.one(".profile-link");a7.setStyle("minHeight",Y);if(a4.length){a8.append(this.moduleapi.getString("STR.SHOW.LESS"));if(a6){a6.removeClass(X);}V.Array.each(a4,function(ba){ba.type=ba.declared?"declared":"";ba.selected=ba.state===1?aI:ba.state===-1?aa:"";a8.append(V.Lang.sub(this.moduleapi.getString("STR.BUTTON.WIKIID"),ba));},this);}this.repaint();this.currentRemovalMenu=a5;},handleRemovalMenuFeedback:function(a3,a7){if(!this.userinfo.isLoggedIn()){return;}var Y,a5;function a6(a8){if(V.Lang.isFunction(a7)){a7(t,a8);}}function a4(a8){if(V.Lang.isFunction(a7)){a7(M,a8);}}Y={_subAction:"int_manage",interest:a3};a5={success:a6,failure:a4,scope:this};this.makeInterestRequest(Y,a5);},makeRequestToGetMixerActions:function(Y,a3){this.transportHelperService.makeRequest({type:"module",moduleId:this.id,args:{_action:"show",_subAction:"getMixerActions",uuids:Y}},a3);},makeInterestRequest:function(Y,a3){var a4=a3?a3:{};this.transportHelperService.makeRequest({type:"module",moduleId:T,args:V.merge({_action:"show"},Y)},a4);},onRemovalMenuLoginClick:function(a5){var a4=a5.ancestor(aq,M,"#"+V.DOM.generateID(this.body)),a3=V.mix(this.instrumentation.getBeaconKeys(a4),{itc:1,pos:0}),a7=a5.get("text"),a8={},a6=t,Y=[];a7=(a7&&a7.length>8)?a7.substring(0,8):a7;this.clearRemovalTimer();this.currentRemovalMenu=ai;a4.all("span.wikiid").each(function(ba){var bc=ba.getAttribute(aZ),a9="neu-"+(ba.hasClass(aI)?"pos":ba.hasClass(aa)?"neg":""),bb=ba.hasClass(aI)?1:ba.hasClass(aa)?-1:0;if(ba.hasClass(aI)||ba.hasClass(aa)){a8[bc]={"new":bb,current:0,type:"declared"};a6=M;Y.push(V.merge(a3,{slk:a9,ltxt:bc}));}});if(a6){this.storage.setItem(aO,{wikiids:a8,beacons:Y});}this.storage.setItem(al,a5.hasClass("fblogin")?aY:h);},updateDislikedInterests:function(){if(!this.removalMenuEnabled){return;}var Y;if(!this.userinfo.isLoggedIn()){this.loginService.configClick({selector:".type_stream .remove a",clickHandler:V.bind(this.onRemovalMenuLoginClick,this)});}else{Y=this.storage.getItem(aO);if(Y){if(V.Object.size(Y.wikiids)>0){this.handleRemovalMenuFeedback(Y.wikiids,M);}V.Array.each(Y.beacons,function(a3){this.instrumentation.fireBeacon(a3);},this);this.storage.removeItem(aO);}this.storage.removeItem(al);}},parseInterests:function(a3){var Y=a3&&a3.hasAttribute(c)?a3.getAttribute(c):ai,a4=Y?V.Object.values(this.interestsService.get(Y.split("|"))):[];V.Array.each(a4,function(a5){a5.streamEligible=(a5.url&&(a5.count>=this.minArticleCount));},this);return a4;},clearRemovalTimer:function(Y){if(this.itemRemovalTimer){this.itemRemovalTimer.cancel();this.itemRemovalTimer=ai;}},setRemovalTimer:function(){this.itemRemovalTimer=V.later(5000,this,function(){this.fancyRemove(this.currentRemovalMenu);this.currentRemovalMenu=ai;});},removeContent:function(a4){var a3,Y;a4=V.one(a4);if(a4&&a4.hasAttribute(n)){a3=a4.getAttribute(n);this.recordClosed(a3);if(this.removalMenuEnabled){if(this.currentRemovalMenu){this.clearRemovalTimer();this.fancyRemove(this.currentRemovalMenu);this.currentRemovalMenu=ai;}this.showRemovalMenu(a4);}else{if(!this.swipeMenu){this.fancyRemove(a4);}}if(this.userinfo.isLoggedIn()&&this.writeMixerActions){Y={_subAction:"article_feedback",uuid:a3,state:"disliked",mixerAction:"dislike"};this.makeInterestRequest(Y);}this.instrumentation.fireYwaBeacon(V.mix({itc:1,action:aF,outcome:"rmct",slk:"rm",sec:"td-strm-ctrl"},this.instrumentation.getBeaconKeys(a4)));}},setSortMode:function(a5,a3){var a4=this.instrumentation,Y;if(a5===this.sortBy){return;}this.sortBy=a5;this.statemgr.saveUserSetting("sb",a5,this.moduleapi);this.onFilter(this.filter);if(a3){this.updateControls();Y=(a5===a?"sort-t":"sort-c");a4.fireBeacon({sec:"set-strm",itc:1,slk:Y,action:aF,outcome:"sort"});}},toggleCollapsibleStream:function(a5){var a6=this.body.all(aq),a4=a6.filter(".expanded-item"),a3=a5.one("i"),a7,Y={sec:"td-strm",elm:"btn",itc:1,action:aF};if(a5.hasClass("expand")){a5.setHTML(this.moduleapi.getString("STR.STREAM.COLLAPSE")+" "+a3.get("outerHTML"));a7=M;Y.slk="xpnd";Y.elmt="xpnd";a5.removeClass("expand");a4.removeClass("dn");}else{a5.setHTML(this.moduleapi.getString("STR.STREAM.EXPAND")+" "+a3.get("outerHTML"));a7=t;Y.slk="clps";Y.elmt="clps";a5.addClass("expand");a4.addClass("dn");}a6.removeClass("no-bottom-border").filter(":not(.dn)").pop().addClass("no-bottom-border");this.instrumentation.fireBeacon(Y);this.statemgr.saveUserSetting("es",a7,this.moduleapi);V.Global.fire("pane-manager:sync-nav-pane-scroll");},updateControls:function(){var Y=this.body.one(".controls"),a3,a4,a5=this.filter.category,a6=this.sortBy;if(!Y){return;}a3=Y.one(".sort");Y.all(av).removeClass(i);if(a3){if(a5===ar){a3.addClass(o).setAttribute(o,o);a6=a;}else{a3.removeClass(o).removeAttribute(o);}a4=a3.one('input[value="'+a6+'"]');if(a4){a4.set(i,M).ancestor(av).addClass(i);}}},filterBeacon:function(a4){var a3,a5,Y={ltxt:a4.getContent(),cpos:a4.get("parentNode").all(".interest-filter").indexOf(a4)+1,itc:1};if(a4.ancestor(J)){Y.sec="fltr-strm-ft";Y.slk="filter-d";this.instrumentation.fireBeacon(Y);}else{if(a4.ancestor(".interest-list")){a3=a4.ancestor(aq);a5=this.instrumentation.getBeaconKeys(a3);Y.slk="filter-i";Y.sec=a5.sec;Y.g=a5.g;Y.woe=this.woeid;Y.ccode=this.ccode;Y.intl=this.intl;this.instrumentation.fireBeacon(Y);}}},deleteSavedArticle:function(Y){if(this.saveForLaterWidget){this.saveForLaterWidget.deleteArticle(Y);}var a3=this.body.all(aq),a4=this.body.one(".strm-error-msg");if(this.filter.category===ae&&a4&&a3&&a3.size()===0){a4.removeClass(X);}this.updateSflHeader(a3.size());},updateSflHeader:function(a3){var a4=this.body.one(".saved-stories-header"),Y;if(a4){Y=a4.one(".saved-header-count");if(Y){Y.setHTML(a3);}if(a3===0){a4.one(".saved-header-count-wrap").addClass("d-n");}}},onSaveArticle:function(a4,Y){if(!a4){return;}var a3=V.merge(this.instrumentation.getBeaconKeys(a4),{sec:"td-strm-ctrl",slk:Y,itc:1,action:aF,outcome:((Y==="sv")?"svct":"undo")});this.instrumentation.fireBeacon(a3);},onSignedOutSaveClick:function(a3){if(!a3){return;}var Y=V.merge(this.instrumentation.getBeaconKeys(a3),{sec:"td-strm-ctrl",action:aF,outcome:"login"});this.instrumentation.fireYwaBeacon(Y);},registerWithRapid:function(){var a4=this.instrumentation,a3=this.rapidContainer,Y=a4.getBeaconKeys(a3);if(a4.isModuleTracked(a3)){a4.refreshModule(a3);}else{a4.addModule(a3,Y&&Y.sec?Y.sec:"td-strm");}},cacheNativeAdData:function(){var Y=this.body.all(an+"["+aM+"]");this.clearNativeAdData();if(Y.size&&Y.size()>0){Y.each(function(a4,a3){this.nativeAds.push({node:a4,y:a4.getY(),height:a4.get(B)});},this);return true;}return false;},clearNativeAdData:function(){this.nativeAds=[];},beaconVisibleNativeAds:function(){var a4,a3,Y,a5;if(this.nativeAds.length>0){a4=this.scrollDomNode;a3=this.getScrollNodeHeight();Y=this.nativeAds.length-1;while(Y>=0){a5=this.nativeAds[Y];if(((a4.scrollTop+a3)>(a5.y+(a5.height/2)))&&(a4.scrollTop<a5.y)){this.fireNativeAdBeaconWhenReady(a5);this.nativeAds.splice(Y,1);}Y--;}}},fireNativeAdBeaconWhenReady:function(a3){var Y=this;V.later(1000,this,function(){var a7,a9,a5,a8=this.scrollDomNode,a4=this.getScrollNodeHeight();if(((a8.scrollTop+a4)>(a3.y+(a3.height/2)))&&(a8.scrollTop<a3.y)){a7=a3.node.getAttribute(aM);a9=a3.node.getAttribute(e);a5=a3.node.getAttribute(N);if(a7){this.instrumentation.getBeaconImage(a7);a3.node.removeAttribute(aM);}if(a5){try{a5=V.JSON.parse(a5);}catch(a6){}if(a5&&V.Lang.isArray(a5)){V.Array.each(a5,function(ba){Y.instrumentation.getBeaconImage(ba);});}a3.node.removeAttribute(N);}else{if(a9){this.instrumentation.getBeaconImage(a9);a3.node.removeAttribute(e);}}}else{this.nativeAds.push(a3);}});},onAdInfoClick:function(a5,a4){var a3=this.instrumentation.getBeaconKeys(a4),Y=a5.test(at)?"sp":a5.test(f)?"adv":"info";this.instrumentation.fireYwaBeacon(V.mix(a3,{slk:Y,ad:1,action:"click",rspns:"nav"}));},initGlobalListeners:function(){this.listeners.push(V.Global.on("media:remove-node",function(Y){if(Y.node.contains(this.body)){this.onviewunload("default");}},this));this.listeners.push(V.Global.on(K+":initialized",this.onReqMgrInitialized,this));this.listeners.push(V.Global.on(K+":active-content-changed",this.onReqMgrActiveContentChange,this));this.listeners.push(V.Global.on("pane-manager:scroll-mode-change",this.setupScroll,this));this.listeners.push(V.Global.on(S,function(Y){this.moduleapi.broadcast(S,Y);},this));},onReqMgrInitialized:function(Y){if(Y&&Y.metadata){this.substituteDataInTemplate(Y.metadata);}},onReqMgrActiveContentChange:function(a4){var Y=V.Object.getValue(a4,["uuid"]),a3=Y&&this.getItemByUuid(Y)||ai;b.YUI.namespace("type_stream").activeItemId=this.activeItemId=Y;if(a3&&this.interestFiltersBroadcast){this.broadcastEntities(a3);}if(this.highlightActive){this.highlightItem(a3);}},substituteDataInTemplate:function(a3){var Y=a3&&a3.uuid&&this.getItemByUuid(a3.uuid);if(Y&&Y.hasClass(X)){if(a3.url&&a3.title){a3=V.merge({summary:a3.description||"",pubdate:"",attribution:""},a3);Y.setHTML(V.Lang.sub(Y.getHTML(),a3)).removeClass(X);}else{Y.remove();}}},highlightItem:function(Y){this.body.all(l).removeClass(q);if(Y&&!Y.hasClass(aD)){Y.addClass(q);}},broadcastEntities:function(a3){var a4={url:"",uuid:"",entities:[]},Y;if(a3){Y=a3.one("h3 a");if(Y){a4.url=Y.getAttribute("href");}if(a3.hasAttribute(n)){a4.uuid=a3.getAttribute(n);}if(this.interestFiltersBroadcast&&a3.hasAttribute(c)){a4.entities=this.parseInterests(a3);}}if(!this.evtStreamEntities){this.evtStreamEntities=V.Global.publish(W,{fireOnce:M,async:M});this.customEvents.push(this.evtStreamEntities);}else{if(this.evtStreamEntities.fireOnce){this.evtStreamEntities.applyConfig({fireOnce:t,async:t},M);}}this.evtStreamEntities.fire(a4);},broadcastDynamicFilters:function(Y){if(!this.evtStreamDynamicFilters){this.evtStreamDynamicFilters=V.Global.publish(H,{fireOnce:M,async:M});this.customEvents.push(this.evtStreamDynamicFilters);}else{if(this.evtStreamDynamicFilters.fireOnce){this.evtStreamDynamicFilters.applyConfig({fireOnce:t,async:t},M);}}this.evtStreamDynamicFilters.fire(Y);}};}());/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("storage_service",function(d){var i="MPServices",e="StorageProvider",f=true,h=false,g=null,a={},b={},j=g;function c(k){this._moduleId=k;this.onReady(function(){this.ready=f;},this);}c.prototype={_moduleId:g,ready:h,onReady:function(l,k){d.StorageLite.on("storage-lite:ready",function(){l.call(k);});},getItem:function(k){var l;try{l=b[k]||d.StorageLite.getItem(k,f);}catch(m){j.logError(this._moduleId,m.message);}finally{if(l&&d.Object.owns(l,"$v")&&(!l.$e||l.$e>+(new Date()))){b[k]=l;return l.$v;}delete b[k];return g;}},setItem:function(l,p,k){var m;try{m={$v:p,$e:k?+(new Date())+k:0};d.StorageLite.setItem(l,m,f);b[l]=m;return f;}catch(o){if(/QUOTA_EXCEEDED_ERR/.test(o.message)){try{d.StorageLite.removeItem(l);d.StorageLite.setItem(l,m,f);b[l]=m;return f;}catch(n){j.logError(this._moduleId,n.message);}}else{j.logError(this._moduleId,o.message);}return h;}},removeItem:function(k){try{delete b[k];d.StorageLite.removeItem(k);return f;}catch(l){j.logError(this._moduleId,l.message);return h;}},getSet:function(k,n){var p=this.getItem(k),m=+(new Date()),o=h,l={};d.Object.each(p,function(r,q){if(d.Object.owns(r,"$v")&&(!r.$e||r.$e>m)){l[q]=r.$v;}else{o|=delete p[q];}});if(o){this.setItem(k,p);}return n?d.Object.keys(l):l;},addToSet:function(l,m,n,k){var o=this.getItem(l)||{};o[m]={$v:n,$e:k?+(new Date())+k:0};return this.setItem(l,o);},removeFromSet:function(k,l){var m=this.getItem(k);if(m&&d.Object.owns(m,l)){delete m[l];return this.setItem(k,m);}return h;}};d.namespace(i)[e]={name:"storage",getService:function(l,k){if(!j){j=l.getService("metrologger");}if(!a[k]){a[k]=new c(k);}return a[k];}};if(d.ModulePlatform){d.ModulePlatform.registerService(d[i][e]);}},"0.0.1",{requires:["gallery-storage-lite","metrologger"]});/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("login",function(e){var x=null,k="MPServices",r="LoginProvider",q=e.ModulePlatform,l=e.config.win,n="p_30345826",z="ylogin",o="a."+z+",.login-tooltip",i="click",v="vertical",u=/http[s]?:\/\/[\S]*[&|?].done=(.*)/,p,A,B,g=x,f,d,c,j=x,m=[],s;function y(){c.one("#cookie-refresh").remove();if(j){j();}}function b(F){var E=l.location.protocol+"//"+e.config.win.location.host,C=encodeURIComponent(E+"/credstore_proxy/CredStoreEventsProxy.php?callback_function=cookie_refresh"),D='<iframe id="cookie-refresh" src="https://login.yahoo.com/config/refresh_cookie?.done='+C+'" height="0px" width="0px" class="vh"></iframe>';j=F;c.append(D);}function a(E,D,C){var F;if(B){F=B.makeRequest({type:"module",moduleId:n,args:e.merge({_action:"show",_subAction:"getButtons",noups:1},D)},{success:function(G){if(E&&G.html){E.setContent(G.html);}if(e.Lang.isFunction(C)){C();}},failure:function(G){},scope:this});}}function t(E){var C=E.doneParams||"",D=l.location.protocol+"//"+l.location.hostname+C;l.location.replace(D);}function h(F){var D=F.currentTarget,C,E=A.getProperty("ywa.rapid.enabled.modules");if(D){if(D.test("a."+z+'[target="_blank"]')){F.preventDefault();l.open(D.getAttribute("href"),"login","width=320,height=450,directories=0,titlebar=0,toolbar=0,location=0,status=0,menubar=0,scrollbars=no,resizable=no, top="+(F.pageY+100)+", left="+(F.pageX-200),true);}else{if(D.test("a."+z+'[target="_top"]')){C=D.getAttribute("href");if(e.Lang.isString(C)&&!u.test(C)){C+=(C.indexOf("?")?"&":"?")+".done="+encodeURIComponent(l.location.href);D.setAttribute("href",C);}}}if(D.test("a."+z)){if(typeof(E)=="object"&&E.hasOwnProperty("default-p_30345826")){p.fireBeacon(p.getBeaconKeys(D));}}if(D.test("a."+z)){e.Array.each(m,function(G){if(D.test(G.selector)&&e.Lang.isFunction(G.clickHandler)){G.clickHandler(D);}});}}}function w(){var G={parentNode:c,className:["y-tooltip-login"],pointerClass:"img-sprite",position:{box:"l",arrow:"r"},autohide:true},D={sec:"login-tooltip",cacheKey:"login-svc",layout:v,title:"Sign in to save your preference",narrow:1},H=[],E,F,C;C={init:function(){var I=this;F=f.create(G);e.on("scroll",function(){I.hide();});F.getNode().on("mouseout",function(){E=e.later(3000,this,function(){I.hide();});});F.getNode().on("mouseover",function(){E.cancel();});},_showTooltip:function(K,J){var I=this;if(E){E.cancel();}F.show(K,J);E=e.later(J.hideDelay||3000,this,function(){I.hide();});},show:function(N){var K=e.mix(N.buttonConfig||{},D),J=e.mix(N.tooltipCong||{},G),M=this,L,I;if(!N.pointAtMeNode){return;}if(!H[K.cacheKey]){L=e.Node.create("<div></div>");I=function(){H[K.cacheKey]=L;M._showTooltip(N.pointAtMeNode,e.mix({msg:L},J));};a(L,K,I);}else{e.later(250,this,function(){M._showTooltip(N.pointAtMeNode,e.mix({msg:H[K.cacheKey]},J));});}},hide:function(){if(F&&F.isVisible()){F.hide();}}};C.init();return C;}s={getTooltip:function(){if(!g){g=new w();}return g;},configClick:function(D){var E=D.clickHandler||x,C=D.selector||"";m.push({selector:C,clickHandler:E});return this;},getButtons:a,refreshCookie:b};e.namespace(k);e[k][r]={name:"login",getService:function(D,C){p=D.getService("instrumentation");A=D.getService("moduleplatform");f=D.getService("tooltip");B=D.getModuleApi(C);d={spid:A.getProperty("credstore.spid"),host:A.getProperty("yql.host"),path:A.getProperty("yql.path"),publicPath:A.getProperty("yql.public.path"),store:A.getProperty("yql.store"),crumb:A.getProperty("yql.crumb"),env:A.getProperty("yql.env")};if(!c){c=e.one("body");c.delegate(i,h,o,this);}return s;},onCookieRefresh:y,onYSignIn:t};if(q){q.registerService(e[k][r]);}},"1.0");/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("interests_service",function(b){var i="MPServices",d="InterestsProvider",e=true,f=null,j=b.guid(),g="interests_service|",h="interests:change",c={},k=f;function a(){b.Global.detachAll(g+"*");b.Global.on(g+h,this._onInterestsChange,this);}a.prototype={_fireWithOrigin:function(l,n){var m={origin:j,data:n};this.fire(l,m);},_onInterestsChange:function(l){if(l.origin!==j){this.set(l.data);}},get:function(n,m){var o,l={};b.Array.each(n||b.Object.keys(c),function(p){o=b.Object.owns(c,p)?b.merge(c[p]):f;if(o&&(!m||m(o,p))){l[p]=o;}});return l;},getById:function(l){return this.get([l])[l]||f;},set:function(m){var l={};b.Object.each(m,function(n,o){this.update(o,n,e);l[o]=b.merge(c[o]);},this);this._fireWithOrigin(h,l);return this;},update:function(o,m,l){var n={};if(b.Object.owns(c,o)){b.mix(c[o],m,e);}else{m.id=o;c[o]=b.merge(m);}if(!l){n[o]=b.merge(c[o]);this._fireWithOrigin(h,n);}return this;}};b.augment(a,b.EventTarget,e,f,{broadcast:2,emitFacade:e});b.namespace(i)[d]={name:"interests",getService:function(m,l){if(!k){k=new a();}return k;}};if(b.ModulePlatform){b.ModulePlatform.registerService(b[i][d]);}},"0.0.1",{requires:["event-custom-base"]});/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("stream_action_drawer",function(Q){var W=null,J=true,v=false,aj="click",an=5*60*1000,au=2*24*60*60*1000,al=80,c="data-uuid",aw="YPROP:SAVE",ap="height",U="MPServices",H="StreamSocialProvider",e=Q.ModulePlatform,h={LIKE:1,NEUTRAL:0,DISLIKE:-1},q=Q.Node.create('<span class="action-drawer-login"></span>'),k="like",aa="dislike",ah="saveforlater",D=".social-actions",a=".social-icon",G=".save-button",I=".check-button",L=".remove",j=".delete",m=G+","+I+","+L+","+j,Z=".saved,.liked,.disliked,.flagged",ao=".entity",r=".entity-list",S=".entity-msg",t=".done-button",ak=".action-drawer-login",u="li",ab=".menu",R=".flag-content-item",ae="drawer-open",F="drawer-transition",ag="highline",ai="saved",X="liked",K="neutral",A="disliked",am="ads_disliked",p="pos",at="neu",az="neg",s="flagged",n="put-update",av="delete-update",x="savedarticles",B="actionRestore",E="flagDetailsRestore",l="declareFeedback",z="removeStreamItem",d="onFlagDone",ad="recordFlag",O="deleteSaved",f="drawerToggleStart",aq="drawerToggleComplete",i="checked",P="input",g="saveforlater:newsaved",T="p_30345860",M="p_30345831",ar,N,w,C,V,ac,af,b,ay="",o=J,ax=0,y;y=function(Y){var aA=W,aB=w.isLoggedIn();if(C&&!aB){if(af.getString("STR.ACTIONDRAWER.LOGIN.TEMPLATE")){q.setContent(af.getString("STR.ACTIONDRAWER.LOGIN.TEMPLATE"));}else{C.getButtons(q,{sec:"td-strm-dr",layout:"horizontal",title:af.getString("STR.ACTIONDRAWER.LIKEDCTA"),narrow:1});}C.configClick({selector:ak+" a",clickHandler:Q.bind(this.onLoginBtnClick,this)});}if(N){N.removeItem(x);aA=N.getItem(B);if(aA){if(aB){this.restoreAction(aA);}N.removeItem(B);}}this.viewingSavedStories=ac?ac.isSflPage:v;this.flagContentEnabled=ac?ac.flagContentEnabled:v;this.sourceDeclarationEnabled=ac?ac.sourceDeclarationEnabled:v;this.timerInProcess=null;};y.prototype={disableButtons:function(){o=v;},restoreAction:function(aA){var aB={},Y;if(aA.type===ai){this.makeSaveRequest(n,aA.uuid,J);ar.fireBeacon(aA.beacon);}else{ar.fireBeacon(aA.beacon);if(aA.type===A){this.fire(z,{uuid:aA.uuid,animate:v});aB={uuid:aA.uuid,state:h.DISLIKE};}else{aB={uuid:aA.uuid,state:h.LIKE};}this.fire(l,aB);Y=(aA.type===X)?k:aa;this.markItemFeedbackInMixer(aA.uuid,aA.type,Y);}},handleSaveClick:function(aC){var aD=this.currentItem.hasClass(ai),aB,aA=this.currentItem.getAttribute(c),Y=Q.merge(ar.getBeaconKeys(this.currentItem),{sec:"td-strm-ctrl",itc:1,action:aj});if(!aD||this.viewingSavedStories){if(this.viewingSavedStories){Y.slk="rm";Y.outcm="rmsvct";Y.rspns="rmct";}else{Y.slk="unsv";Y.outcm="unsvct";}aB=av;}else{Y.slk="sv";Y.outcm="svct";aB=n;Q.Global.fire(g);}ar.fireBeacon(Y);this.makeSaveRequest(aB,aA);if(this.viewingSavedStories){if(o){this.closeDrawer(this.currentDrawer);}this.currentItem.remove();this.fire(O,{});}},handleLikeClick:function(aB){var aE=this.currentItem.hasClass(X),aA=this.currentItem.hasClass(A),Y=this.currentItem.getAttribute(c),aD=aE?"1":"0",aC=aA?"-1":aE?"0":"1";if(!o){this.currentItem.removeClass(A);if(this.currentDrawer){this.currentDrawer.removeClass(A);if(aE){this.currentDrawer.addClass(X);}else{this.currentDrawer.removeClass(X);}}}this.fireItemInterestChange(aD,aC,X);this.markItemFeedbackInMixer(Y,aE?X:K,k);if(aA){this.markItemFeedbackInMixer(Y,K,aa);}if(!aE){if(this.currentItem.hasClass(ae)&&this.currentDrawer&&this.currentDrawer.hasClass(s)){this.buildFlagEntityList();}if(o){this.closeDrawer(this.currentDrawer);}}else{this.buildEntityList(v);}},handleDislikeClick:function(aB){var aE=this.currentItem.hasClass(X),aA=this.currentItem.hasClass(A),Y=this.currentItem.getAttribute(c),aD=aA?"-1":"0",aC=aE?"1":aA?"0":"-1";if(!o){this.currentItem.removeClass(X);this.currentItem.removeClass(am);if(this.currentDrawer){this.currentDrawer.removeClass(X);this.currentDrawer.removeClass(am);if(aA){this.currentDrawer.addClass(A);}else{this.currentDrawer.removeClass(A);}}}this.fireItemInterestChange(aD,aC,A);this.markItemFeedbackInMixer(Y,aA?A:K,aa);if(aE){this.markItemFeedbackInMixer(Y,K,k);}if(!aA){if(this.currentItem.hasClass(ae)&&this.currentDrawer&&this.currentDrawer.hasClass(s)){this.buildFlagEntityList();}if(o){this.closeDrawer(this.currentDrawer);}}else{this.buildEntityList(v);this.updateConfirmationMsg(af.getString("STR.ENTITY.LIST.DISLIKED.MSG"));}},handleFlagClick:function(aB){var aA=this.currentItem.hasClass(s),Y=Q.merge(ar.getBeaconKeys(this.currentItem),{sec:"td-strm-ctrl",elm:"btn",elmt:"flag",itc:1,intl:ac.intl,action:aj});if(this.currentDrawer){if(aA){this.currentDrawer.addClass(s);}else{this.currentDrawer.removeClass(s);}}if(!aA){Y.slk="unflag";Y.outcm="unflagitm";Y.rspns="clps";Q.later(300,this,function(){this.fire(ad,{item:this.currentItem,flag:v});});if(this.currentItem.hasClass(ae)&&this.currentDrawer&&this.currentDrawer.hasClass(X)){this.buildEntityList(J);}else{if(this.currentItem.hasClass(ae)&&this.currentDrawer&&this.currentDrawer.hasClass(A)){this.buildEntityList(J);this.updateConfirmationMsg(af.getString("STR.ENTITY.LIST.DISLIKED.MSG"));}}if(o){this.closeDrawer(this.currentDrawer);}}else{Y.slk="flag";Y.outcm="flagitm";Y.rspns="xpnd";Q.later(300,this,function(){this.fire(ad,{item:this.currentItem,flag:J});});this.buildFlagEntityList();}ar.fireBeacon(Y);},markItemFeedbackInMixer:function(Y,aB,aA){if(!ac.writeMixerActions||!w.isLoggedIn()){return;}if(!ay&&ac.listId){ay="LISTID:"+ac.listId;}this.makeInterestRequest({_subAction:"article_feedback",uuid:Y,state:aB,mixerAction:aA,curFilter:ay});},updateConfirmationMsg:function(aA){var Y=this.currentDrawer.one(S);if(Y){Y.setHTML(aA);}},buildEntityList:function(aO){var aI=o?af.getString("STR.ENTITY.LIST.TEMPLATE"):af.getString("STR.REMOVE.MENU"),aQ=af.getString("STR.ENTITY.ITEM.TEMPLATE"),aP="",aA,Y,aE,aM=this.currentDrawer.one(S),aF=this.currentDrawer.one(r),aK=this.currentDrawer.one(t),aH=this.currentDrawer.one(ab),aB,aN="",aC={},aL,aD=J,aR=0,aG=this.currentDrawer,aJ=this;if(aF&&aK&&aM){aF.remove();aK.remove();aM.remove();}if(aH){aH.remove();}aB=V.get(this.currentItem.getAttribute("data-wikiids").split("|"));Q.Object.each(aB,function(aS){aC={state:(aS.state===1)?p:(aS.state===-1)?az:at,type:aS.declared?"declared":"inferred",id:aS.id,name:aS.name};aN+=Q.Lang.sub(aQ,aC);});if(!o){this.currentItem.addClass("y-pattern").addClass("hover");aG.removeClass("dn");}if(this.sourceDeclarationEnabled){aE=this.currentItem.getAttribute("data-sourceid");if(aE){aP=af.getString("STR.SOURCE.ITEM.TEMPLATE");Y=V.getById(aE);aA={state:Y?((Y.state===1)?p:((Y.state===-1)?az:at)):at,id:aE,name:Y.name};aP=Q.Lang.sub(aP,aA);}}if(Q.Object.size(aB)>0){aN=Q.Lang.sub(aI,{source:aP,entities:aN});aG.append(aN);if(o){aG.one(D).setStyle(ap,al+"px");aL=al+aG.one(r).get("clientHeight")+aG.one(t).get("clientHeight")+aG.one(S).get("clientHeight")+30;}else{aG.all(ao).addClass("d-ib");aL=aG.one(ab).get("offsetHeight");aK=aG.one(t);}aD=v;}else{if(!aO){if(o){aG.one(D).remove();}aN=af.getString("STR.ACTIONDRAWER.NOENTITIESLIKE");aG.append(aN);aL=aG.one(".no-entities").get("clientHeight");aD=v;aR=aG.hasClass(A)?0:3000;this.timerInProcess=Q.later(aR,this,function(){if(aJ.currentDrawer===aG){aJ.closeDrawer(aG,ac.nonPersonalStream);}});if(aG.hasClass(A)){aG.addClass("dn");this.currentItem.removeClass(ae);return aD;}}}aG.transition({height:aL+"px",duration:0.3,easing:"ease-in",on:{start:function(){aJ.fire(f,{item:aJ.currentItem});},end:function(){aJ.fire(aq,{item:aJ.currentItem});if(aK){aK.removeClass("dn");}aJ.repaint();}}});return aD;},showAdsDislikeBtns:function(){if(!this.currentItem||!this.currentDrawer){return;}var aE=af.getString("STR.ACTIONDRAWER.ADSDISLIKEDCTA"),aI=af.getString("STR.ACTIONDRAWER.ADSDISLIKEOPTN1"),aB=af.getString("STR.ACTIONDRAWER.ADSDISLIKEOPTN2"),aH=af.getString("STR.ACTIONDRAWER.ADSDISLIKEOPTN3"),aC=af.getString("STR.ACTIONDRAWER.ADSDISLIKEOPTN4"),aG=af.getString("STR.ACTIONDRAWER.ADSDISLIKE.SOMETHING.ELSE"),aM=Q.Node.create('<span class="action-drawer-login"></span>'),aF,aJ=this.currentDrawer.one(ak),Y,aL,aA,aD,aK=this;if(aJ){aJ.remove();}if(af.getString("STR.ADSDISLIKE.TEMPLATE")){aD={cdata:aE,option1:aI,option2:aB,option3:aH,option4:aC,somethingq:aG};aL=Q.Lang.sub(af.getString("STR.ADSDISLIKE.TEMPLATE"),aD);aM.setContent(aL);aJ=this.currentDrawer.appendChild(aM.cloneNode(J));this.currentDrawer.all("input[type=radio]").each(function(aN){aN.on("change",function(aS){var aQ=aS.target.ancestor(".embed",true),aP=parseInt(aK.currentDrawer.getStyle("height"),10),aO=aQ.one("input[id=ads-dislike-option4]"),aR=aQ.one("input[name=ads-dislike-option]:checked");if(aR.compareTo(aO)){aQ.one(".custom_resp").removeClass("hidden");aQ.one(".custom_resp").addClass("required");aP=aP+40;aK.currentDrawer.transition({height:aP+"px",duration:0.2,easing:"ease-in"},function(){var aT=aK.currentDrawer.one("#cmnt");aT.focus();});}else{if(!aQ.one(".custom_resp").hasClass("hidden")){aQ.one(".custom_resp").addClass("hidden");aQ.one(".custom_resp").removeClass("required");aP=aP-40;aK.currentDrawer.transition({height:aP+"px",duration:0.2,easing:"ease-in"});}}});});}else{aJ=this.currentDrawer.appendChild(q.cloneNode(J));}aF=aJ.appendChild(af.getString("STR.ACTIONDRAWER.DONE"));this.currentDrawer.addClass(am);aA=this.currentDrawer.one(".title");if(aA){if(o){this.currentDrawer.one(D).setStyle(ap,al+"px");Y=al+this.currentDrawer.one(".embed").get("clientHeight");if(aF){Y+=(aF.get("clientHeight")+5);}}else{this.currentItem.addClass("y-pattern").addClass("hover");this.currentDrawer.removeClass("dn");Y=this.currentDrawer.one(".embed").get("offsetHeight");this.fireItemInterestChange("-1","0",A);}this.currentDrawer.transition({height:Y+"px",duration:0.3,easing:"ease-in",on:{start:function(){aK.fire(f,{item:aK.currentItem});},end:function(){aK.fire(aq,{item:aK.currentItem});aK.repaint();}}});}},showLoginBtns:function(){if(!this.currentItem||!this.currentDrawer){return;}var aA=this.currentItem.hasClass(ai)?af.getString("STR.ACTIONDRAWER.SAVEDCTA"):this.currentItem.hasClass(X)?af.getString("STR.ACTIONDRAWER.LIKEDCTA"):this.currentItem.hasClass(s)?af.getString("STR.ACTIONDRAWER.FLAGGEDCTA"):af.getString("STR.ACTIONDRAWER.DISLIKEDCTA"),aD,Y=this.currentDrawer.one(ak),aB,aF,aE,aC=this;if(Y){Y.remove();}Y=this.currentDrawer.appendChild(q.cloneNode(J));if(this.currentItem.hasClass(A)){aD=Y.appendChild(af.getString("STR.ACTIONDRAWER.DONE"));}aE=this.currentDrawer.one(".title");if(aE){aE.setHTML(aA);if(o){this.currentDrawer.one(D).setStyle(ap,al+"px");aB=al+this.currentDrawer.one(".embed").get("clientHeight");if(aD){aB+=(aD.get("clientHeight")+5);}}else{this.currentItem.addClass("y-pattern").addClass("hover");this.currentDrawer.removeClass("dn");aB=this.currentDrawer.one(".embed").get("offsetHeight");if(this.currentItem.hasClass(X)||this.currentItem.hasClass(A)){aF=this.currentItem.hasClass(X);this.fireItemInterestChange(aF?"1":"-1","0",aF?X:A);}}this.currentDrawer.transition({height:aB+"px",duration:0.3,easing:"ease-in",on:{start:function(){aC.fire(f,{item:aC.currentItem});},end:function(){aC.fire(aq,{item:aC.currentItem});aC.repaint();}}});}},onLoginBtnClick:function(Y){var aC=Q.merge(ar.getBeaconKeys(this.currentItem),{sec:"td-strm-ctrl",action:aj}),aB=this.currentItem.getAttribute(c),aA;if(this.currentItem.hasClass(X)){aA=X;aC.slk="neu-pos";aC.outcome="itemdecl";}else{if(this.currentItem.hasClass(A)){aA=A;aC.slk="neu-neg";aC.outcome="itemdecl";}else{if(this.currentItem.hasClass(ai)){aA=ai;aC.slk="sv";aC.outcome="svct";}else{if(this.currentItem.hasClass(s)){aA=s;aC.slk="flag";aC.outcome="flagitm";}}}}N.setItem(B,{type:aA,uuid:aB,beacon:aC},an);},onDoneClick:function(Y){var aC,aD,aA,aF,aB,aE="";if(this.currentDrawer.hasClass(am)){aC=this.currentDrawer.one("#ads-dislike-option4");aD=aC?aC.get("vlaue"):0;aA=this.currentDrawer.one("[name=ads-dislike-option]:checked");aF=aA?aA.get("value"):aD;aB=this.currentDrawer.one("#cmnt");if(aF===aD){aE=aB.get("value")||"";}}else{ar.fireBeacon({sec:"td-strm-dr",slk:"btn-dn",itc:1,action:aj});}this.closeDrawer(this.currentDrawer);},onFilter:function(Y){this.currentItem=W;this.currentDrawer=W;ay=Y.category;this.viewingSavedStories=v;if(ay===aw){this.viewingSavedStories=J;}},populateHighlineMenu:function(){var aB=this.currentItem.getAttribute("data-highline-id"),aA={id:encodeURIComponent(aB)},Y=this.currentDrawer.all("a");Y.each(function(aC){aC.setAttribute("href",Q.Lang.sub(aC.getAttribute("data-base-url"),aA));});},onEntityClick:function(aJ){var aD=aJ.target,aI=aD.ancestor(ao,J),aB=aI.getAttribute("data-interestid"),aG=aI.hasClass(p)?h.LIKE:aI.hasClass(az)?h.DISLIKE:h.NEUTRAL,aC=aI.hasClass("inferred")?"inferred":"declared",Y,aE=aI.hasClass("source"),aA={},aF={},aH={};if(this.currentDrawer.hasClass(X)&&!aI.hasClass(p)){aI.addClass(p);aI.removeClass(at).removeClass(az);Y=h.LIKE;}else{if(this.currentDrawer.hasClass(A)&&!aI.hasClass(az)){aI.addClass(az);aI.removeClass(at).removeClass(p);Y=h.DISLIKE;}else{aI.addClass(at);aI.removeClass(p).removeClass(az);Y=h.NEUTRAL;}}aH={"new":Y.toString(),current:aG.toString(),type:"entity",id:aB};if(aE){aH.source=1;}this.fire(l,{interestObj:aH,item:this.currentItem,markFeedback:v});aA={"new":Y,current:aG,type:aC};if(aE){aA.name=aI.get("text");}aF[aB]=aA;this.makeInterestRequest({_subAction:"int_manage",interest:aF});V.update(aB,{state:Y});},toggleDrawer:function(aI,aD,aB){var aF=w.isLoggedIn(),aE="",aJ,aG=J,Y,aH=aI.get("nextSibling"),aK=this,aC=this.currentItem&&this.currentItem.hasClass(ae)&&aI!==this.currentItem,aA={sec:"td-strm-ctrl",itc:1,action:aj};if(aH&&aH.hasClass("flag-thankyou-msg-drawer")){aH.remove();}if(aC){this.closeDrawer(this.currentDrawer,true);}this.currentItem=aI;Y=this.currentItem.getAttribute(c);if(!aD&&this.currentItem&&!this.currentItem.hasClass(ae)){if(o){if(this.viewingSavedStories){aE=af.getString("STR.SAVE.BTN.TEMPLATE");}else{if(aI.hasClass(ag)){aE=af.getString("STR.HIGHLINE.BTN.TEMPLATE");}else{aE=af.getString("STR.SHARE.BTN.TEMPLATE");}}}aJ='<li class="action-drawer y-pattern">'+aE+"</li>";this.currentItem.insert(aJ,"after");this.currentDrawer=this.currentItem.get("nextSibling");if(o){this.currentDrawer.one(D).removeClass("v-h").removeClass("closed");this.actionBtnListner=this.currentDrawer.delegate(aj,this.onActionDrawerClick,m,this);}if(this.flagContentEnabled){this.flagItemListner=this.currentDrawer.delegate("change",this.onFlagItemClick,R+" "+P,this);}this.entityListner=this.currentDrawer.delegate(aj,this.onEntityClick,ao,this);this.doneBtnListner=this.currentDrawer.delegate(aj,this.onDoneClick,t,this);if(!this.viewingSavedStories&&(o||aF)){if(aB){this.currentDrawer.addClass(aB);}else{if(this.currentItem.hasClass(ai)){this.currentDrawer.addClass(ai);}if(this.currentItem.hasClass(X)){this.currentDrawer.addClass(X);if(o){aG=this.buildEntityList(J);}}if(this.currentItem.hasClass(A)){this.currentDrawer.addClass(A);if(o){aG=this.buildEntityList(J);}this.updateConfirmationMsg(af.getString("STR.ENTITY.LIST.DISLIKED.MSG"));}if(this.currentItem.hasClass(am)){this.currentDrawer.addClass(am);if(o){aG=this.buildEntityList(J);}this.updateConfirmationMsg(af.getString("STR.ENTITY.LIST.DISLIKED.MSG"));}if(this.currentItem.hasClass(s)){this.currentDrawer.addClass(s);if(o){this.buildFlagEntityList();}}}if(this.currentItem.hasClass(ag)){this.currentDrawer.addClass(ag);this.populateHighlineMenu();}}else{if(!o&&!aF){aG=v;}}if(aG&&o){this.currentDrawer.transition({height:al+"px",duration:0.3,easing:"ease-in",on:{start:function(){aK.currentDrawer.addClass(F);},end:function(){aK.currentDrawer.removeClass(F);}}});Q.config.win.scrollTo(0,aK.currentItem.getY()-ax);}this.currentItem.addClass(ae);if(!o){this.currentDrawer.addClass("dn");}aA.rspns="xpnd";}else{if(!aD&&this.currentItem&&this.currentItem.hasClass(ae)){this.closeDrawer(this.currentDrawer);this.currentDrawer=W;aA.rspns="clps";if(o){this.actionBtnListner.detach();}this.entityListner.detach();this.doneBtnListner.detach();if(this.flagContentEnabled){this.flagItemListner.detach();}}}if(o){aA.slk="btn-dr";ar.fireBeacon(aA);}},closeDrawer:function(aA,Y){var aC=w.isLoggedIn(),aG=this.currentItem,aH=this.currentDrawer,aD=aA.one(t),aF=this,aB,aE={};if(aD){aD.addClass("dn");}if(aG.hasClass(s)&&aH.one(".flag-entity-msg")){Q.later(300,this,function(){this.fire(d,{item:aG,drawer:aH,animate:J});});}if(aG.hasClass(A)||aG.hasClass(am)){aB=aG.hasClass(am)?am:A;if(aG.hasClass(s)&&aH.one(".flag-entity-msg")){Q.later(300,this,function(){this.fire(z,{item:aG,animate:J,immediate:J,action:aB});});}else{Q.later(300,this,function(){this.fire(z,{item:aG,animate:J,immediate:v,action:aB});});}}if(!aC&&this.currentItem){aG.removeClass(ai).removeClass(X).removeClass(A).removeClass(s).removeClass(am);}aE.start=function(){aF.fire(f,{item:aG});if(!aA.one(r)&&!aA.one(ak)){aA.addClass(F);}};aE.end=function(){aF.fire(aq,{item:aG});aA.remove();aG.removeClass(ae);if(!o){aG.removeClass("y-pattern").removeClass("hover");}aF.repaint();};if(Y){aE.start();aA.setStyle("height","0px");aE.end();}else{aA.transition({height:"0px",duration:0.3,easing:"default",on:aE});}},fireItemInterestChange:function(aB,aA,Y){this.fire(l,{interestObj:{"new":aB,current:aA,type:"content",action:Y},item:this.currentItem,markFeedback:v});},onActionDrawerClick:function(Y){var aC=Y.target,aA=aC.ancestor(u),aB=aC.ancestor(a,J),aE=w.isLoggedIn(),aD;Y.preventDefault();if(aB.test(G)){aA.toggleClass(ai);this.currentItem.toggleClass(ai);if(aE){this.handleSaveClick(aB);}else{aA.removeClass(X).removeClass(A);this.currentItem.removeClass(X).removeClass(A);}}else{if(aB.test(j)){this.handleSaveClick(aB);}else{if(aB.test(I)){aA.toggleClass(X);this.currentItem.toggleClass(X);if(aE){this.handleLikeClick(aB);}else{aD=aA.hasClass(X);this.fireItemInterestChange(aD?"0":"1",aD?"1":"0",X);aA.removeClass(ai).removeClass(A);this.currentItem.removeClass(ai).removeClass(A);}aA.removeClass(A);this.currentItem.removeClass(A);}else{aA.toggleClass(A);this.currentItem.toggleClass(A);if(aE){this.handleDislikeClick(aB);}else{aD=aA.hasClass(A);this.fireItemInterestChange(aD?"0":"-1",aD?"-1":"0",A);aA.removeClass(ai).removeClass(X);this.currentItem.removeClass(ai).removeClass(X);}aA.removeClass(X);this.currentItem.removeClass(X);}}}if(!aE){if(this.currentDrawer.test(Z)&&(!ac.nonPersonalStream||!aB.test(L))){this.showLoginBtns();}else{this.closeDrawer(this.currentDrawer);}}},buildFlagEntityList:function(){var aL=this.currentDrawer,aB=this.currentItem.getAttribute(c),aM=this.currentDrawer.one(".flag-content-form"),aI=this.currentDrawer.one(S),aE=this.currentDrawer.one(r),aF=this.currentDrawer.one(t),aA=this.currentDrawer.one(ab),aJ=this.currentDrawer.one(".no-entities"),aH=N.getItem(E)||{},aC=[],aG,Y=0,aD=0,aK=this;if(aE&&aF&&aI){aE.remove();aF.remove();aI.remove();}if(this.timerInProcess){this.timerInProcess.cancel();this.timerInProcess=null;if(this.currentDrawer){if(this.currentDrawer.hasClass(X)){this.currentDrawer.removeClass(X);this.currentItem.addClass(X);}}if(aJ){aJ.remove();}}if(aA){aA.remove();}if(!o){this.currentItem.addClass("y-pattern").addClass("hover");aL.removeClass("dn");}aL.addClass(s);aG=af.getString("STR.ACTIONDRAWER.FLAGMENU");if(aG){aM=aL.append(aG);Y=120;}aC=aH[aB];if(aC&&aC.length>0){for(aD=0;aD<aC.length;aD++){aL.one('[value="'+aC[aD]+'"]').set("checked",true);}}this.currentDrawer.transition({height:Y+"px",duration:0.3,easing:"ease-in",on:{end:function(){aK.repaint();}}});},onFlagItemClick:function(aD){var aF=aD.target,aC=aF.ancestor(R,J,ab),aE=aD.target.getAttribute("value"),aG=this.currentItem.getAttribute(c),aB=N.getItem(E)||{},aA=[],Y=Q.merge(ar.getBeaconKeys(this.currentItem),{sec:"td-strm-dr",slk:aC.get("text"),elm:"inpt",elmt:"flag",itc:1,intl:ac.intl,action:aj});aA=aB[aG]||[];if(aF.get(i)){Y.outcm="flagcat";if(aA.indexOf(aE)<0){aA.push(aE);}}else{Y.outcm="unflagcat";if(aA.indexOf(aE)>-1){aA.splice(aA.indexOf(aE),1);}}aB[aG]=aA;N.setItem(E,aB,au);ar.fireBeacon(Y);},repaint:function(){var Y=this.currentItem?this.currentItem.get("parentNode"):W;if(Q.UA.ie&&Q.UA.ie<8&&Y){Y._node.className=Y._node.className;}},makeSaveRequest:function(aA,Y){if(!ay&&ac.listId){ay="LISTID:"+ac.listId;}af.makeRequest({type:"module",moduleId:T,args:{_action:"save",_subAction:aA,noups:1,uuid:Y,mixerAction:ah,curFilter:ay}},{});},makeInterestRequest:function(Y){b.makeRequest({type:"module",moduleId:M,args:Q.merge({_action:"show"},Y)},{});}};Q.augment(y,Q.EventTarget);Q.namespace(U);Q[U][H]={name:"stream_action_drawer",getService:function(aB,aA){var Y;b=aB.getService("transport_helper",aA);af=aB.getModuleApi(aA);ar=aB.getService("instrumentation");N=aB.getService("storage");w=aB.getService("userinfo");C=aB.getService("login",aA);V=af.getService("interests");ac=af.getContextData();if((!Q.UA.android||Q.UA.android>=3)){Y=Q.one(".banner-wrapper")||Q.one(".type_masthead")||Q.one(".type_mastheadlite")||Q.one(".yog-hd");if(Y){ax=Y.get("offsetHeight");}}return new y();}};if(e){e.registerService(Q[U][H]);}},"1.0");/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
(function(){var c=null,d=c,b="click",a="default";YModules.type_login={body:c,id:"",moduleapi:c,init:function(e){d=e.getService("yui");this.id=e.getId();this.moduleapi=e;},onviewload:function(e){if(e===a){this.body=this.moduleapi.getViewNode(e);}},onviewunload:function(e){if(e===a){this.body=c;}},onviewevent:function(g,f){if(g===a){if(f.type===b){this.onClick(f);}else{}}}};}());/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
(function(){var i="click",f="submit",b="blur",c="default",h="edit",j="recent-quotes",d=true,g=false,e=null,a=e;YModules.type_finance={id:"",body:e,moduleapi:e,instrumentation:e,currentBucket:e,orderTable:"asc",viewevents:[i,f,"focus","mouseover"],allTickers:e,autocompleteEnabled:g,autocompleteLoaded:g,settingspaneEnabled:g,arcadeTransport:e,resizeThrottle:250,tabliteService:e,tabs:e,tabNavigationMode:e,searchBoxBlur:e,stateMgr:e,apiMigrationMode:g,newDefaultPfId:e,init:function(k){this.id=k.getId();this.moduleapi=k;a=this.moduleapi.getService("yui");this.autocompleteEnabled=k.getContextData("enableAutocomplete");this.settingspaneEnabled=k.getContextData("enableSettingspane");this.inlineEditEnabled=k.getContextData("enableRQInlineEdit");this.crumb=k.getContextData(".crumb");this.instrumentation=k.getService("instrumentation");this.rapidEnabled=this.moduleapi.getContextData("rapid.enabled");this.currentBucket=k.getContextData("currentBucket");this.autocompleteUrl=k.getContextData("autocompleteUrl");if(this.settingspaneEnabled){this.arcadeTransport=this.platform?this.platform.getService("arcade_transport"):k;}this.tabliteService=k.getService("tablite");this.tabNavigationMode=k.getContextData("tabNavigationMode");this.stateMgr=this.moduleapi.getService("statemgr");this.apiMigrationMode=k.getContextData("apiMigrationMode");this.newDefaultPfId=k.getContextData("newDefaultPf");},onviewload:function(m){var l=this.moduleapi,k;if(m==c){this.body=this.moduleapi.getViewNode(c);this.autocompleteLoaded=g;if(this.rapidEnabled){this.instrumentation.refreshModule(this.body);}this.allTickers=l.getContextData("allTickers");this.loadingInfo=l.getContextData("loadingInfo")||e;k=this.body.one(".tab-"+this.tabNavigationMode);this.tabs=new this.tabliteService({moduleApi:l,body:this.body,tabWidget:k,navMode:this.tabNavigationMode});this.tabs.setup();if(this.newDefaultPfId){this.arcadeTransport.makeRequest({type:"module",moduleId:this.id,args:{_action:"save",_subAction:"setdefault",pf_id:this.newDefaultPfId}},{success:function(){this.newDefaultPfId=e;l.refreshView(c);},failure:function(){},scope:this,argument:{subAction:"setdefault"}});}if(!this.searchBoxBlur){this.searchBoxBlur=this.body.delegate("blur",function(q){var p=q.target,o=p.get("value"),n=p.getAttribute("placeholder");if(o.length===0||n===o){p.addClass("quotes-input-inactive");p.set("value",n);}},".quotes-input");}}else{if(m==h){this.editBody=l.getViewNode(m);if(this.rapidEnabled&&!this.instrumentation.isModuleTracked(this.editBody)){this.instrumentation.addModule(this.editBody,"app-fin");}}}},onviewevent:function(u,q){var n=this.moduleapi,r=q.target,t=q.type,o=r.getAttribute("placeholder"),p=r.get("value"),s,k,l,m,v;if(u==c){if(t===i){if(this.apiMigrationMode){v=this.moduleapi.getContextData("myPortfolioUrl")||"//finance.yahoo.com/portfolios";m=r.getData("tabid");if(m&&m==="my-portfolio"){a.config.win.location.href=v;return;}}if(r.ancestor(".toggle",d)){if(r.hasClass("edit-link")){return;}q.preventDefault();}if(this.rapidEnabled&&r.hasClass("tab")){this.instrumentation.fireBeacon(r);}if(r.ancestor(".settings-cta",d)&&this.settingspaneEnabled){q.preventDefault();n.openView(h);}if(r.ancestor(".markets .down",d)||r.ancestor(".markets .up",d)){k=r.ancestor(".markets");l=k&&k.hasClass("quote-percent");k.all(".down, .up").each(function(z,y){var A=z,x=A.getAttribute("data-changepercent"),w=A.getAttribute("data-change");if(l){A.setContent(A.getContent().replace(x,w));}else{A.setContent(A.getContent().replace(w,x));}});if(l){k.removeClass("quote-percent");}else{k.addClass("quote-percent");}if(this.rapidEnabled){this.instrumentation.fireBeacon(r);}}}if(t==="focus"||t===i){if(r.hasClass("quotes-input")&&o===p){this.emptyInputBox(r);if(r.hasClass("quotes-input-inactive")){r.removeClass("quotes-input-inactive");}}}if(t==="mouseover"&&this.autocompleteLoaded===g&&this.autocompleteEnabled){this.autocompleteLoaded=d;n.getViewNode(c).detach("mouseover");this.initAutocomplete();}}else{if(u==h){if(t==="submit"||(t===i&&r.hasClass("edit-save-btn"))){q.preventDefault();if(r.hasClass("app-close-button")){n.closeView(h);return;}if(t===i&&r.hasClass("edit-save-btn")){r=r.ancestor(".portfolio-form");}if(r.hasClass("portfolio-form")&&r.one('input[name="pf"]')){r.all('input[name="pf"]').each(function(w){if(w.get("checked")===d){s=w.getAttribute("value");}});this.arcadeTransport.makeRequest({type:"module",moduleId:this.id,args:{_action:"save",_subAction:"setdefault",pf_id:s}},{success:function(){n.refreshView(c);this.editBody=n.getViewNode(u);if(this.instrumentation.isModuleTracked(this.editBody)){this.instrumentation.removeModule(this.editBody);}n.closeView(h);},failure:function(){},scope:this,argument:{subAction:"setdefault"}});}else{if(r.hasClass("portfolio-form")){n.closeView(h);}}}}}},initAutocomplete:function(){try{var k=this;a.use("jsonp","jsonp-url","autocomplete",function(o){var n=k.body.one(".quotes-input"),m;if(n){n.plug(o.Plugin.AutoComplete,{source:function(s,t){YAHOO.util={ScriptNodeDataSource:{callbacks:function(w){var v=w.ResultSet.Result,u=[];for(m=0;m<v.length;m++){if(v[m]&&v[m].symbol){u.push({symbol:v[m].symbol,name:v[m].name,pos:m});}}t(u);}}};function q(u,v,w){return o.Lang.sub(u,{callback:"YAHOO.util.ScriptNodeDataSource.callbacks",query:w});}var r=k.autocompleteUrl,p=new o.JSONPRequest(r,{format:q,on:{success:function(u){}}});p.send(s);},resultTextLocator:"symbol",resultFormatter:function(q,p){return o.Array.map(p,function(r){return"<strong>"+r.raw.symbol+"</strong> "+r.raw.name;});},resultHighlighter:"phraseMatch",align:{node:n,points:["tl","bl"]},queryDelay:200,maxResults:10,activateFirstItem:d});n.ancestor("form").on(f,function(p){if(n.ac.get("visible")===d){p.preventDefault();}});n.ac.on("select",function(p){p.preventDefault();if(k.inlineEditEnabled){if(k.stateMgr){k.stateMgr.saveUserSetting("st",j,k.moduleapi);}k.arcadeTransport.makeRequest({type:"module",moduleId:k.id,args:{_action:"save",_subAction:"addrq",s:p.result.text}},{success:function(){if(this.rapidEnabled){var q={rspns:"nav",t1:"a4",t2:"app-fin",t3:"rcnt",sec:"app-fin",slk:p.result.text,elm:"itm",elmt:"qte",itc:0,pos:p.result.raw.pos+1,action:"click"};this.instrumentation.fireBeacon(q);}k.moduleapi.refreshView(c);},failure:function(){},scope:k,argument:{subAction:"addrq"}});}else{n.set("value",p.result.text);n.ancestor("form").submit();}});n.ac.on("visibleChange",function(p){if(p.newVal===d){k.body.one(".app").setStyle("zIndex","10");}else{k.body.one(".app").setStyle("zIndex","");}});}});}catch(l){}},emptyInputBox:function(k){k.set("value","").removeClass("quotes-input-inactive");k.on(b,this.setInputValue,this);},setInputValue:function(l){var k=l.target;if(k.get("value")===""){k.set("value",k.get("defaultValue"));k.addClass("quotes-input-inactive");}k.detach("blur",this.setInputValue);},onviewunload:function(k){if(k==c){this.tabs.teardown();if(this.searchBoxBlur){this.searchBoxBlur.detach();this.searchBoxBlur=e;}}},handleRequests:function(k,o){var l=this.moduleapi,n=this.requestId,m=this.body.getById(this.id+"-loading-info");if(l.isRequestPending(n)){l.abortRequest(n);if(m){m.get("parentNode").removeChild(m);}}this.requestId=l.makeRequest(k,o);}};}());/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
